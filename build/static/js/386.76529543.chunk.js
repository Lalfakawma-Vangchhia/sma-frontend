"use strict";(self.webpackChunkautomation_dashboard=self.webpackChunkautomation_dashboard||[]).push([[386],{386:(e,s,a)=>{a.r(s),a.d(s,{default:()=>f});var t=a(43),i=a(615),n=a(16),o=a(726),l=a(471),r=a(860),c=a(652),d=a(579);const h=[{id:1,name:"Daily Motivation",prompt:"Share an inspiring quote or motivational message for your audience"},{id:2,name:"Product Showcase",prompt:"Highlight your best products with engaging descriptions"},{id:3,name:"Behind the Scenes",prompt:"Share behind-the-scenes content about your business or team"},{id:4,name:"Customer Spotlight",prompt:"Feature customer testimonials or success stories"},{id:5,name:"Industry Tips",prompt:"Share valuable tips and insights related to your industry"},{id:6,name:"Custom",prompt:"custom"}];const m=function(e){let{selectedPage:s,onClose:a,availablePages:i,onPageChange:m}=e;const{isAuthenticated:u}=(0,n.A)(),{addNotification:p}=(0,l.E)(),[g,x]=(0,t.useState)({promptTemplate:"",customStrategyTemplate:"",startDate:"",endDate:"",frequency:"daily",customCron:"",timeSlot:"09:00"}),[v,j]=(0,t.useState)([]),[f,y]=(0,t.useState)([]),[w,b]=(0,t.useState)(null),[N,k]=(0,t.useState)(new Date),[C,F]=(0,t.useState)(!1),[_,S]=(0,t.useState)(0),[P,D]=(0,t.useState)(null),[I,A]=(0,t.useState)(null),[T,B]=(0,t.useState)([]),[M,E]=(0,t.useState)(!1),[W,R]=(0,t.useState)(!0),[L,U]=(0,t.useState)(null),[z,$]=(0,t.useState)(null),[G,H]=(0,t.useState)(!1),[K,O]=(0,t.useState)(""),[V,q]=(0,t.useState)(1),[Y,Q]=(0,t.useState)("desc"),Z=(0,t.useRef)(!1),J=T.reduce((e,s)=>{const a=s.schedule_batch_id||s.scheduled_date;return e[a]||(e[a]=[]),e[a].push(s),e},{}),X=Object.keys(J).sort((e,s)=>{var a,t;const i=(null===(a=J[e][0])||void 0===a?void 0:a.scheduled_date)||e,n=(null===(t=J[s][0])||void 0===t?void 0:t.scheduled_date)||s;return"desc"===Y?n.localeCompare(i):i.localeCompare(n)}),ee=Math.ceil(T.length/5),se=X.slice(5*(V-1),5*V),ae=(0,t.useRef)(null),te=(0,t.useCallback)(()=>{if(!g.startDate)return;const e=g.startDate.split("-"),s=new Date(Date.UTC(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2])));let a=null;if(g.endDate){const e=g.endDate.split("-");a=new Date(Date.UTC(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2])))}const t=[];let i=new Date(s),n=0,o=0;if(a)for(;n<75&&o<50&&!(a&&i>a);){if(i>new Date(Date.now()+648e7))break;let e=!1;switch(g.frequency){case"daily":case"custom":default:e=!0;break;case"weekly":e=i.getUTCDay()===s.getUTCDay();break;case"monthly":e=i.getUTCDate()===s.getUTCDate()}if(e){const e=i.getUTCFullYear()+"-"+String(i.getUTCMonth()+1).padStart(2,"0")+"-"+String(i.getUTCDate()).padStart(2,"0");t.push({id:`row-${o}`,caption:"",mediaFile:null,mediaPreview:null,scheduledDate:e,scheduledTime:g.timeSlot,status:"draft",isSelected:!1}),o++}i.setUTCDate(i.getUTCDate()+1),n++}else{const e=s.getUTCFullYear()+"-"+String(s.getUTCMonth()+1).padStart(2,"0")+"-"+String(s.getUTCDate()).padStart(2,"0");t.push({id:"row-0",caption:"",mediaFile:null,mediaPreview:null,scheduledDate:e,scheduledTime:g.timeSlot,status:"draft",isSelected:!1})}j(t)},[g.startDate,g.endDate,g.frequency,g.timeSlot]);(0,t.useEffect)(()=>{g.startDate&&g.frequency&&te()},[g.startDate,g.endDate,g.frequency,g.timeSlot,te]),(0,t.useEffect)(()=>{if(g.timeSlot){const e=(e=>{const[s,a]=e.split(":"),t=new Date;t.setUTCHours(parseInt(s),parseInt(a),0,0);const i=(t.getUTCHours()+5)%24,n=(t.getUTCMinutes()+30)%60,o=t.getUTCMinutes()+30>=60?1:0;return`${String((i+o)%24).padStart(2,"0")}:${String(n).padStart(2,"0")}`})(g.timeSlot);x(s=>({...s,timeSlot:e}))}},[]);const ie=(0,t.useCallback)(async()=>{E(!0);try{const e=await o.A.getBulkComposerContent(null===s||void 0===s?void 0:s.internalId);e&&e.data&&B(e.data)}catch(e){console.error("Error loading scheduled posts:",e),alert("Failed to load scheduled posts. Please try again.")}finally{E(!1)}},[null===s||void 0===s?void 0:s.internalId]);(0,t.useEffect)(()=>{s&&s.internalId&&ie()},[null===s||void 0===s?void 0:s.internalId,ie,s]),(0,t.useEffect)(()=>{!M&&T.length>0&&console.log("[BulkComposer] Raw scheduledPosts:",T)},[M,T]),(0,t.useEffect)(()=>{console.log("[BulkComposer] Grouped batch keys:",X),console.log("[BulkComposer] Grouped batches:",J)},[X,J]),(0,t.useEffect)(()=>{if(T.length>0&&!Z.current){const e=(new Date).toISOString().split("T")[0],s=X.slice(0,3);J[e]?U(e):s.length>0?U(s[0]):U(null),Z.current=!0}},[T.length,X,J]),(0,t.useEffect)(()=>{q(1)},[Y,ee]);const ne=(0,t.useCallback)((e,s)=>{x(a=>({...a,[e]:s})),"promptTemplate"===e&&s&&j(e=>e.map(e=>({...e,caption:s}))),"endDate"===e&&s&&s===g.startDate?alert("End date cannot be the same as start date. Please select a different end date or leave it empty."):"startDate"===e&&g.endDate&&s>g.endDate&&x(e=>({...e,endDate:""}))},[g.startDate,g.endDate]),oe=(e,s,a)=>{j(t=>t.map(t=>{if(t.id===e){const e={...t,[s]:a};return"caption"===s&&a.trim()&&(e.status="ready"),e}return t}))},le=e=>{e.preventDefault()},re=e=>{const s=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0"),a=v.filter(e=>e.scheduledDate===s);return a.length>0&&console.log("Found posts for date:",s,"Count:",a.length),a},ce=e=>{switch(e){case"published":return(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M20 6L9 17l-5-5"})});case"failed":return(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,d.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"scheduled":return(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("polyline",{points:"12,6 12,12 16,14"})]});case"ready":return(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M9 12l2 2 4-4"}),(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"})]});default:return(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,d.jsx)("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}},de=e=>{switch(e){case"published":return"status-published";case"failed":return"status-failed";case"scheduled":return"status-scheduled";case"ready":return"status-ready";default:return"status-draft"}},he=e=>{$({id:e.id,caption:e.caption,original:e})},me=async()=>{if(z)try{await o.A.updateBulkComposerPost(z.id,z.caption),B(e=>e.map(e=>e.id===z.id?{...e,caption:z.caption}:e)),$(null),alert("Post updated successfully!")}catch(e){console.error("Error updating post:",e),alert("Failed to update post. Please try again.")}},ue=()=>{$(null)},pe=(0,t.useCallback)(async()=>{if(!s)return!1;H(!0),O("Checking page synchronization...");try{const e=await o.A.getSocialAccounts(),a=e.filter(e=>"facebook"===e.platform&&e.is_connected).find(e=>e.platform_user_id===s.id);if(a){if(m){const e={...s,internalId:a.id};m(e)}return O("\u2713 Page is synchronized"),!0}return O("\u26a0 Page is not synchronized with database"),!1}catch(e){return console.error("Error checking page sync:",e),O("\u2717 Failed to check page synchronization"),!1}finally{H(!1)}},[s,m]);return(0,t.useEffect)(()=>{if(s&&!s.internalId){const e=setTimeout(()=>{pe()},1e3);return()=>clearTimeout(e)}s&&s.internalId&&O("\u2713 Page is synchronized")},[s,pe]),(0,d.jsxs)("div",{className:"bulk-composer-panel",children:[(0,d.jsxs)("div",{className:"bulk-composer-header",children:[(0,d.jsxs)("div",{className:"header-content",children:[(0,d.jsx)("h2",{children:"Bulk Composer"}),(0,d.jsx)("p",{className:"header-subtitle",children:"Create and schedule multiple social media posts efficiently"})]}),!u&&(0,d.jsxs)("div",{className:"auth-warning",children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,d.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),(0,d.jsx)("span",{children:"Please log in to schedule posts"})]})]}),(0,d.jsxs)("div",{className:"bulk-composer-scrollable-content",children:[(0,d.jsxs)("div",{className:"strategy-calendar-section",children:[(0,d.jsxs)("div",{className:"strategy-step",children:[(0,d.jsxs)("h3",{children:[(0,d.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Step 1: Strategy & Schedule"]}),(0,d.jsxs)("div",{className:"strategy-form",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Strategy Template"}),(0,d.jsxs)("select",{value:g.promptTemplate,onChange:e=>ne("promptTemplate",e.target.value),className:"form-select",children:[(0,d.jsx)("option",{value:"",children:"Select a template..."}),h.map(e=>(0,d.jsx)("option",{value:e.prompt,children:e.name},e.id))]})]}),"custom"===g.promptTemplate&&(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Custom Strategy Template"}),(0,d.jsx)("textarea",{value:g.customStrategyTemplate,onChange:e=>ne("customStrategyTemplate",e.target.value),placeholder:"Enter your custom strategy template. This will be used by AI to generate captions that follow your specific style and approach...",className:"form-textarea",rows:"3"}),(0,d.jsx)("small",{className:"form-help",children:"Describe your content strategy, tone, style, and any specific requirements for your posts."})]}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Start Date"}),(0,d.jsx)("input",{type:"date",value:g.startDate,onChange:e=>ne("startDate",e.target.value),className:"form-input"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"End Date (Optional)"}),(0,d.jsxs)("div",{className:"end-date-container",children:[(0,d.jsx)("input",{type:"date",value:g.endDate,onChange:e=>ne("endDate",e.target.value),className:"form-input",min:g.startDate,disabled:!g.startDate}),(0,d.jsxs)("button",{type:"button",onClick:()=>ne("endDate",""),className:"btn btn-secondary btn-small",disabled:!g.endDate,title:"Clear end date (single day schedule)",children:[(0,d.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,d.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),"Clear"]})]}),(0,d.jsx)("small",{className:"form-help",children:"Leave empty for single day schedule"})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Time Slot (IST - Indian Standard Time)"}),(0,d.jsx)("input",{type:"time",value:g.timeSlot,onChange:e=>ne("timeSlot",e.target.value),className:"form-input"}),(0,d.jsx)("small",{className:"form-help",children:"All times are in IST (UTC+5:30)."})]})]}),"custom"===g.frequency&&(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Custom Cron Expression"}),(0,d.jsx)("input",{type:"text",value:g.customCron,onChange:e=>ne("customCron",e.target.value),placeholder:"0 9 * * * (daily at 9 AM)",className:"form-input"})]})]})]}),(0,d.jsxs)("div",{className:"calendar-preview-section",children:[(0,d.jsxs)("h3",{children:[(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,d.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,d.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Calendar Preview"]}),(0,d.jsxs)("div",{className:"calendar-container",children:[(0,d.jsxs)("div",{className:"calendar-header",children:[(0,d.jsx)("button",{onClick:()=>k(e=>new Date(e.getFullYear(),e.getMonth()-1)),className:"btn btn-secondary btn-small",children:(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("polyline",{points:"15,18 9,12 15,6"})})}),(0,d.jsx)("h4",{children:N.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,d.jsx)("button",{onClick:()=>k(e=>new Date(e.getFullYear(),e.getMonth()+1)),className:"btn btn-secondary btn-small",children:(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("polyline",{points:"9,18 15,12 9,6"})})})]}),(0,d.jsxs)("div",{className:"calendar-grid",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,d.jsx)("div",{className:"calendar-day-header",children:e},e)),((e,s)=>{const a=((e,s)=>new Date(e,s+1,0).getDate())(e,s),t=((e,s)=>new Date(e,s,1).getDay())(e,s),i=[];for(let n=0;n<t;n++)i.push({day:null,date:null});for(let n=1;n<=a;n++){const a=new Date(e,s,n);i.push({day:n,date:a})}return i})(N.getFullYear(),N.getMonth()).map((e,s)=>(0,d.jsxs)("div",{className:`calendar-day ${e.date?"clickable":""} ${e.date&&re(e.date).length>0?"has-posts":""}`,children:[(0,d.jsx)("span",{className:"day-number",children:e.day}),e.date&&re(e.date).length>0&&(0,d.jsx)("div",{className:"post-indicators",children:re(e.date).map((e,s)=>(0,d.jsx)("div",{className:"post-dot",title:`${e.scheduledTime} - ${e.caption.substring(0,30)}...`},s))})]},s))]})]}),(0,d.jsx)("div",{className:"form-row calendar-options-row",children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Frequency"}),(0,d.jsxs)("select",{value:g.frequency,onChange:e=>ne("frequency",e.target.value),className:"form-select",children:[(0,d.jsx)("option",{value:"daily",children:"Daily"}),(0,d.jsx)("option",{value:"weekly",children:"Weekly"}),(0,d.jsx)("option",{value:"monthly",children:"Monthly"}),(0,d.jsx)("option",{value:"custom",children:"Custom Cron"})]})]})}),"custom"===g.frequency&&(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{children:"Custom Cron Expression"}),(0,d.jsx)("input",{type:"text",value:g.customCron,onChange:e=>ne("customCron",e.target.value),placeholder:"0 9 * * * (daily at 9 AM)",className:"form-input"})]})]})]}),(0,d.jsxs)("div",{className:"composer-grid-section",children:[(0,d.jsxs)("div",{className:"composer-header",children:[(0,d.jsxs)("h3",{children:[(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),(0,d.jsx)("line",{x1:"15",y1:"9",x2:"15",y2:"15"}),(0,d.jsx)("line",{x1:"9",y1:"12",x2:"15",y2:"12"})]}),"Step 2: Content Grid"]}),(0,d.jsxs)("div",{className:"composer-controls",children:[(0,d.jsx)("button",{onClick:()=>{const e={id:`row-${Date.now()}-${Math.random()}`,caption:"",mediaFile:null,mediaPreview:null,scheduledDate:(new Date).toISOString().split("T")[0],scheduledTime:g.timeSlot,status:"draft",isSelected:!1};j(s=>[...s,e])},className:"btn btn-primary btn-small",children:(0,d.jsx)(c.jgn,{size:16})}),(0,d.jsx)("button",{onClick:()=>{f.length===v.length?y([]):y(v.map(e=>e.id))},className:"btn btn-secondary btn-small",children:(f.length,v.length,(0,d.jsx)(c.jkN,{size:16}))}),(0,d.jsx)("button",{onClick:()=>{j(e=>e.filter(e=>!f.includes(e.id))),y([])},disabled:0===f.length,className:"btn btn-danger btn-small",children:(0,d.jsx)(c.b6i,{size:16})}),(0,d.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(console.log("=== Starting Generate Captions for Selected Rows ==="),console.log("Strategy Data:",g),console.log("Selected Rows:",f),0!==f.length)if(g.promptTemplate)try{const s=v.filter(e=>f.includes(e.id)),a=s.map(e=>`Post for ${new Date(e.scheduledDate).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}`);let t;if(console.log("Generated contexts for selected rows:",a),"custom"===g.promptTemplate){if(console.log("Using custom strategy template"),!g.customStrategyTemplate.trim())return void alert("Please enter a custom strategy template first.");console.log("Calling generateBulkCaptions with:",{customStrategy:g.customStrategyTemplate,contexts:a,maxLength:2e3}),t=await o.A.generateFacebookBulkCaptions(g.customStrategyTemplate,a,2e3)}else{console.log("Using predefined strategy template");const s=h.find(e=>e.prompt===g.promptTemplate);if(console.log("Selected template:",s),!s)return void alert("Invalid strategy template selected.");const i=[];for(let t=0;t<a.length;t++)try{console.log(`Generating caption ${t+1}/${a.length} for context:`,a[t]);const e=a[t],n=await o.A.generateFacebookCaptionWithStrategy(s.prompt,e,2e3);console.log(`Caption ${t+1} response:`,n),n.success?i.push({content:n.content,context:e,success:!0}):i.push({content:`Failed to generate caption for: ${e}`,context:e,success:!1,error:n.error||"Unknown error"})}catch(e){console.error(`Error generating caption for context ${a[t]}:`,e),i.push({content:`Failed to generate caption for: ${a[t]}`,context:a[t],success:!1,error:e.message})}t={success:!0,captions:i,total_generated:i.filter(e=>e.success).length}}console.log("Final response:",t),t.success&&t.captions?(j(e=>e.map(e=>{if(f.includes(e.id)){const a=s.findIndex(s=>s.id===e.id),i=t.captions[a];if(i&&i.success)return{...e,caption:i.content,status:"ready"}}return e})),alert(`Successfully generated ${t.total_generated} captions for selected rows!`)):alert("Failed to generate captions. Please try again.")}catch(e){console.error("Error generating captions:",e),alert("Failed to generate captions. Please try again.")}else alert("Please select a strategy template first.");else alert("Please select at least one row to generate captions for.")},disabled:0===v.length||0===f.length,children:"Generate Captions"}),(0,d.jsx)("button",{className:"btn btn-secondary",onClick:async()=>{if(0!==f.length)try{const e=v.filter(e=>f.includes(e.id));for(let s=0;s<e.length;s++){const a=e[s];if(!a.caption||!a.caption.trim()){console.log(`Skipping image generation for row ${a.id} - no caption available`);continue}console.log(`Generating image for row ${a.id} with caption: ${a.caption}`);const t=a.caption.trim(),i=await o.A.generateFacebookImage(t,"feed");i.success&&i.data&&i.data.image_url?(console.log(`Successfully generated image for row ${a.id}:`,i.data.image_url),j(e=>{const s=e.map(e=>e.id===a.id?{...e,mediaFile:null,mediaPreview:i.data.image_url,mediaGenerated:!0,status:"ready"===e.status?"ready":"draft"}:e);return console.log("Updated rows:",s),console.log("Row after update:",s.find(e=>e.id===a.id)),s})):console.log(`Failed to generate image for row ${a.id}:`,i)}alert("Image generation completed!")}catch(e){console.error("Error generating images:",e),alert("Failed to generate images. Please try again.")}else alert("Please select at least one row to generate images.")},disabled:0===v.length||0===f.length,children:"Generate Images"})]})]}),(0,d.jsx)("div",{className:"composer-grid-container",children:(0,d.jsxs)("div",{className:"composer-grid",ref:ae,children:[(0,d.jsxs)("div",{className:"grid-header grid-row",children:[(0,d.jsx)("div",{className:"grid-cell header-cell"}),(0,d.jsxs)("div",{className:"grid-cell header-cell",title:"Caption",children:[(0,d.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"9"}),(0,d.jsx)("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]}),(0,d.jsx)("span",{className:"header-label",children:"Caption"})]}),(0,d.jsxs)("div",{className:"grid-cell header-cell",title:"Media",children:[(0,d.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,d.jsx)("polyline",{points:"21,15 16,10 5,21"})]}),(0,d.jsx)("span",{className:"header-label",children:"Media"})]}),(0,d.jsxs)("div",{className:"grid-cell header-cell",title:"Date",children:[(0,d.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,d.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,d.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),(0,d.jsx)("span",{className:"header-label",children:"Date"})]}),(0,d.jsxs)("div",{className:"grid-cell header-cell",title:"Time",children:[(0,d.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("polyline",{points:"12,6 12,12 16,14"})]}),(0,d.jsx)("span",{className:"header-label",children:"Time"})]}),(0,d.jsxs)("div",{className:"grid-cell header-cell",title:"Status",children:[(0,d.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("path",{d:"M9 12l2 2 4-4"})]}),(0,d.jsx)("span",{className:"header-label",children:"Status"})]})]}),(0,d.jsx)("div",{className:"grid-body",children:v.map((e,s)=>{return(0,d.jsxs)("div",{className:"grid-row "+(e.isSelected?"selected":""),draggable:!0,onDragStart:()=>{return s=e.id,void b(s);var s},onDragOver:le,onDrop:()=>(e=>{if(w&&w!==e){const s=[...v],a=s.findIndex(e=>e.id===w),t=s.findIndex(s=>s.id===e),[i]=s.splice(a,1);s.splice(t,0,i),j(s)}b(null)})(e.id),children:[(0,d.jsx)("div",{className:"grid-cell",children:(0,d.jsx)("input",{type:"checkbox",checked:f.includes(e.id),onChange:()=>{return s=e.id,void y(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s}})}),(0,d.jsx)("div",{className:"grid-cell caption-cell",children:(0,d.jsxs)("div",{className:"caption-container",children:[(0,d.jsx)("textarea",{value:e.caption,onChange:s=>oe(e.id,"caption",s.target.value),placeholder:"Enter your post caption...",className:"caption-input",rows:"3",style:{resize:"none"}}),(0,d.jsx)("button",{onClick:()=>(e=>{const s=v.find(s=>s.id===e);s&&D({rowId:e,caption:s.caption,scheduledDate:s.scheduledDate,scheduledTime:s.scheduledTime})})(e.id),className:"expand-btn",title:"Expand caption",children:(0,d.jsx)(c.j1Q,{size:16})})]})}),(0,d.jsx)("div",{className:"grid-cell media-cell",children:(0,d.jsx)("div",{className:"media-options",children:e.mediaPreview||e.mediaFile?(0,d.jsxs)("div",{className:"media-preview",children:[(console.log(`Rendering media for row ${e.id}:`,{mediaFile:e.mediaFile,mediaPreview:e.mediaPreview,mediaGenerated:e.mediaGenerated,hasMediaPreview:!!e.mediaPreview,hasMediaFile:!!e.mediaFile}),e.mediaPreview&&!e.mediaFile?(console.log(`Rendering generated image for row ${e.id}:`,e.mediaPreview),(0,d.jsx)("img",{src:e.mediaPreview,alt:"Generated Preview"})):null!==(a=e.mediaFile)&&void 0!==a&&null!==(t=a.type)&&void 0!==t&&t.startsWith("image/")?(console.log(`Rendering uploaded image for row ${e.id}:`,e.mediaPreview),(0,d.jsx)("img",{src:e.mediaPreview,alt:"Uploaded Preview"})):(console.log(`Rendering video for row ${e.id}:`,e.mediaPreview),(0,d.jsx)("video",{src:e.mediaPreview,controls:!0}))),(0,d.jsx)("button",{onClick:()=>(e=>{const s=v.find(s=>s.id===e);var a,t;s&&s.mediaPreview&&A({rowId:e,mediaUrl:s.mediaPreview,mediaType:null!==(a=s.mediaFile)&&void 0!==a&&null!==(t=a.type)&&void 0!==t&&t.startsWith("image/")||s.mediaPreview&&!s.mediaFile?"image":"video",caption:s.caption})})(e.id),className:"view-media-btn",title:"View media",children:(0,d.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,d.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}),(0,d.jsx)("button",{onClick:()=>{return s=e.id,void j(e=>e.map(e=>e.id===s?{...e,mediaFile:null,mediaPreview:null,mediaGenerated:!1}:e));var s},className:"remove-media-btn",title:"Remove media",children:(0,d.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,d.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):(0,d.jsxs)("div",{className:"media-option-group",children:[(0,d.jsx)("input",{type:"file",accept:"image/*,video/*",onChange:s=>((e,s)=>{const a=s.target.files[0];if(a){const s=new FileReader;s.onload=s=>{j(t=>t.map(t=>t.id===e?{...t,mediaFile:a,mediaPreview:s.target.result}:t))},s.readAsDataURL(a)}})(e.id,s),className:"media-input",id:`media-upload-${e.id}`}),(0,d.jsxs)("label",{htmlFor:`media-upload-${e.id}`,className:"media-option-btn upload-btn",children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,d.jsx)("polyline",{points:"7,10 12,15 17,10"}),(0,d.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Upload"]}),(0,d.jsxs)("button",{onClick:()=>(async e=>{try{const s=v.find(s=>s.id===e);if(!s)return void alert("Row not found.");const a=s.caption.trim();if(!a)return void alert("Please add a caption first to generate an image.");const t=await o.A.generateFacebookImage(a,"feed");t.success&&t.data&&t.data.image_url?(console.log(`Successfully generated image for row ${e}:`,t.data.image_url),j(s=>{const a=s.map(s=>s.id===e?{...s,mediaFile:null,mediaPreview:t.data.image_url,mediaGenerated:!0,status:"ready"===s.status?"ready":"draft"}:s);return console.log("Updated rows after image generation:",a),console.log("Updated row:",a.find(s=>s.id===e)),a})):(console.log(`Failed to generate image for row ${e}:`,t),alert("Failed to generate image. Please try again."))}catch(s){console.error("Error generating media:",s),alert("Failed to generate image. Please try again.")}})(e.id),className:"media-option-btn generate-btn",children:[(0,d.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Generate"]})]})})}),(0,d.jsx)("div",{className:"grid-cell date-cell",children:(0,d.jsx)("input",{type:"date",value:e.scheduledDate,onChange:s=>oe(e.id,"scheduledDate",s.target.value),className:"date-input"})}),(0,d.jsx)("div",{className:"grid-cell time-cell",children:(0,d.jsx)("input",{type:"time",value:e.scheduledTime,onChange:s=>oe(e.id,"scheduledTime",s.target.value),className:"time-input",style:{width:"90px"}})}),(0,d.jsx)("div",{className:"grid-cell status-cell",children:(0,d.jsxs)("span",{className:`status-badge ${de(e.status)}`,children:[ce(e.status)," ",e.status]})})]},e.id);var a,t})})]})})]}),(0,d.jsxs)("div",{className:"queue-confirmation",children:[(0,d.jsxs)("h3",{children:[(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("polyline",{points:"12,6 12,12 16,14"})]}),"Step 3: Schedule & Publish"]}),(0,d.jsxs)("div",{className:"confirmation-stats",children:[(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"Total Posts:"}),(0,d.jsx)("span",{className:"stat-value",children:v.length})]}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"With Captions:"}),(0,d.jsx)("span",{className:"stat-value",children:v.filter(e=>e.caption.trim()).length})]}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"Ready to Schedule:"}),(0,d.jsx)("span",{className:"stat-value",children:v.filter(e=>"ready"===e.status).length})]}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"With Media:"}),(0,d.jsx)("span",{className:"stat-value",children:v.filter(e=>e.mediaFile||e.mediaPreview).length})]})]}),C&&(0,d.jsxs)("div",{className:"schedule-progress",children:[(0,d.jsx)("div",{className:"progress-bar",children:(0,d.jsx)("div",{className:"progress-fill",style:{width:`${_}%`}})}),(0,d.jsxs)("span",{className:"progress-text",children:["Scheduling posts... ",Math.round(_),"%"]})]}),(0,d.jsx)("div",{className:"confirmation-actions",children:(0,d.jsx)("button",{onClick:async()=>{if(!s||!s.internalId||0===v.length){if(console.log("Selected Page Debug:",s),!s)return void alert("Please select a page first before scheduling posts.");if(!s.internalId){if(!await new Promise(e=>{e(window.confirm(`The selected page "${s.name}" is not properly synced with the database.\n\nWould you like to try syncing it automatically?\n\nClick "OK" to try syncing, or "Cancel" to abort scheduling.`))}))return;if(!await pe()){return void(window.confirm('Automatic sync failed. This usually happens when:\n\n1. The page was recently connected\n2. Facebook permissions need to be refreshed\n\nWould you like to:\n\u2022 Click "OK" to disconnect and reconnect Facebook\n\u2022 Click "Cancel" to try manual sync later')&&alert('Please use the "Disconnect Facebook" button in the main interface, then reconnect Facebook and try again.'))}}if(0===v.length)return void alert("No posts to schedule. Please create some posts first.")}if(!u)return void alert("Please log in to schedule posts.");const e=v.filter(e=>"ready"===e.status&&e.caption.trim());if(console.log("=== Bulk Schedule Debug Info ==="),console.log("Selected Page:",s),console.log("Using Database ID (internalId):",s.internalId),console.log("Facebook Page ID (for reference):",s.id),console.log("Total Composer Rows:",v.length),console.log("Ready Posts:",e.length),console.log("Ready Posts Data:",e),0!==e.length){F(!0),S(0);try{var a;const t=s.internalId;console.log("Using database social_account_id:",t);const i=await Promise.all(e.map(async e=>{var s;let a=null;if(e.mediaFile)try{a=await(0,r.bB)(e.mediaFile),console.log("Converted uploaded file to base64 for row:",e.id)}catch(n){console.error("Error converting uploaded file to base64:",n)}else if(e.mediaPreview&&!e.mediaFile)try{console.log("Fetching generated image for row:",e.id,"URL:",e.mediaPreview);const s=await fetch(e.mediaPreview);if(!s.ok)throw new Error(`Failed to fetch image: ${s.status}`);const t=await s.blob();a=await new Promise((e,s)=>{const a=new FileReader;a.onloadend=()=>{a.result?e(a.result):s(new Error("Failed to convert image to base64"))},a.onerror=()=>s(new Error("FileReader error")),a.readAsDataURL(t)}),console.log("Converted generated image to base64 for row:",e.id)}catch(n){console.error("Error converting generated image to base64:",n),a=null}const t={caption:e.caption,scheduled_date:e.scheduledDate,scheduled_time:e.scheduledTime,media_file:a,media_filename:e.mediaFile?e.mediaFile.name:e.mediaPreview?"generated_image.jpg":null},i=new Date(`${t.scheduled_date}T${t.scheduled_time}:00Z`);return i<=new Date&&console.warn(`Post for row ${e.id} is scheduled in the past:`,i),console.log("Prepared post data for row:",e.id,{caption:(null===(s=t.caption)||void 0===s?void 0:s.substring(0,50))+"...",scheduled_date:t.scheduled_date,scheduled_time:t.scheduled_time,scheduled_datetime_utc:i.toISOString(),has_media:!!t.media_file,media_filename:t.media_filename}),t})),n={social_account_id:t,posts:i};console.log("=== Sending to Backend ==="),console.log("Database Page ID (social_account_id):",t),console.log("Number of posts:",i.length),console.log("Request payload structure:",{social_account_id:n.social_account_id,posts_count:n.posts.length,first_post_sample:n.posts[0]?{caption:(null===(a=n.posts[0].caption)||void 0===a?void 0:a.substring(0,50))+"...",scheduled_date:n.posts[0].scheduled_date,scheduled_time:n.posts[0].scheduled_time,has_media:!!n.posts[0].media_file,media_filename:n.posts[0].media_filename}:"No posts"}),console.log("=== Timezone Debug Info ==="),console.log("Current UTC time:",(new Date).toISOString()),console.log("Current local time:",(new Date).toString()),console.log("Sample post scheduled datetime:",i[0]?new Date(`${i[0].scheduled_date}T${i[0].scheduled_time}:00Z`).toISOString():"No posts");const l=await o.A.bulkSchedulePosts(n);console.log("=== Backend Response ==="),console.log("Full response:",l),j(s=>s.map(s=>e.some(e=>e.id===s.id)?{...s,status:"scheduled"}:s)),S(100);const c=Array.isArray(l.results)?l.results.filter(e=>e.success).length:e.length,d=Array.isArray(l.results)?l.results.filter(e=>!e.success).length:0;console.log("=== Results Summary ==="),console.log("Success count:",c),console.log("Failed count:",d),l.results&&Array.isArray(l.results)&&(console.log("Detailed results:",l.results),l.results.forEach((e,s)=>{e.success||console.error(`Post ${s+1} failed:`,e.error||e.message||"Unknown error")})),d>0?alert(`Scheduled ${c} posts successfully. ${d} posts failed. Check console for details.`):(alert(`Successfully scheduled ${c} posts!`),c>0&&p({type:"success",platform:"facebook",strategyName:g.promptTemplate||"Bulk Schedule",message:`Successfully scheduled ${c} Facebook posts! You'll receive alerts 10 minutes before each post goes live.`})),await ie()}catch(n){var t,i;if(console.error("=== Frontend Error ==="),console.error("Error scheduling posts:",n),console.error("Error details:",{message:n.message,stack:n.stack,name:n.name}),null!==(t=n.message)&&void 0!==t&&t.includes("social_account_id")||null!==(i=n.message)&&void 0!==i&&i.includes("not found")){window.confirm(`Page synchronization error detected.\n\nError: ${n.message}\n\nWould you like to try syncing the page again?`)&&await pe()}else alert(`Error scheduling posts: ${n.message||"Please try again."}`)}finally{F(!1),S(0)}}else alert("No posts are ready to be scheduled. Please generate captions first.")},disabled:C||0===v.filter(e=>"ready"===e.status).length||!u,className:"btn btn-primary btn-large",children:C?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M21 12a9 9 0 11-6.219-8.56"})}),"Scheduling..."]}):u?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("polyline",{points:"12,6 12,12 16,14"})]}),"Schedule Ready Posts (",v.filter(e=>"ready"===e.status).length,")"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),(0,d.jsx)("polyline",{points:"10,17 15,12 10,7"}),(0,d.jsx)("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]}),"Please Log In to Schedule"]})})})]}),(0,d.jsxs)("div",{className:"scheduled-posts-section",children:[(0,d.jsxs)("div",{className:"scheduled-posts-header",children:[(0,d.jsxs)("h3",{children:[(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,d.jsx)("polyline",{points:"14,2 14,8 20,8"}),(0,d.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,d.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),(0,d.jsx)("polyline",{points:"10,9 9,9 8,9"})]}),"Scheduled Posts"]}),(0,d.jsxs)("div",{className:"scheduled-posts-controls",children:[(0,d.jsxs)("button",{onClick:()=>R(!W),className:"btn btn-secondary btn-small",children:[W?"Hide":"Show"," Scheduled Posts (",T.length,")"]}),(0,d.jsxs)("button",{onClick:ie,disabled:M,className:"btn btn-secondary btn-small",children:[M?(0,d.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M21 12a9 9 0 11-6.219-8.56"})}):(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M23 4v6h-6"}),(0,d.jsx)("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),"Refresh"]})]})]}),W&&(0,d.jsx)("div",{className:"scheduled-posts-container",children:M?(0,d.jsxs)("div",{className:"loading-scheduled-posts",children:[(0,d.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M21 12a9 9 0 11-6.219-8.56"})}),"Loading scheduled posts..."]}):se.length>0?(0,d.jsxs)("div",{className:"scheduled-posts-list",children:[se.length>0&&(0,d.jsxs)("div",{className:"schedule-pagination-controls",children:[(0,d.jsx)("button",{onClick:()=>q(e=>Math.max(1,e-1)),disabled:1===V,children:"Prev"}),(0,d.jsxs)("span",{children:["Page ",V," of ",ee]}),(0,d.jsx)("button",{onClick:()=>q(e=>Math.min(ee,e+1)),disabled:V===ee,children:"Next"}),(0,d.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,d.jsx)(c.SEk,{size:20}),(0,d.jsxs)("select",{value:Y,onChange:e=>{Q(e.target.value)},children:[(0,d.jsx)("option",{value:"desc",children:"Newest First"}),(0,d.jsx)("option",{value:"asc",children:"Oldest First"})]})]})]}),se.map((e,s)=>{const a=J[e],t=L===e,i=a.map(e=>e.scheduled_date).sort(),n=i.length>1?`${i[0]} - ${i[i.length-1]}`:i[0];return(0,d.jsxs)("div",{className:"scheduled-post-group"+(t?" expanded":""),children:[(0,d.jsxs)("div",{className:"schedule-group-header",children:[(0,d.jsxs)("div",{className:"schedule-info",children:[(0,d.jsx)("h4",{className:"schedule-date",children:n}),(0,d.jsxs)("div",{className:"schedule-stats",children:[(0,d.jsxs)("span",{className:"post-count",children:[a.length," scheduled"]}),(0,d.jsx)("span",{className:"status-breakdown",children:(()=>{const e=a.reduce((e,s)=>(e[s.status]=(e[s.status]||0)+1,e),{});return Object.entries(e).map(e=>{let[s,a]=e;return(0,d.jsxs)("span",{className:`status-chip ${s.toLowerCase()}`,children:[a," ",s]},s)})})()})]})]}),(0,d.jsx)("div",{className:"expand-controls",children:(0,d.jsx)("button",{onClick:()=>{return s=e,void U(e=>e===s?null:s);var s},className:"expand-btn"+(t?" expanded":""),title:t?"Collapse":"Expand",children:(0,d.jsx)(c.j1Q,{size:16})})})]}),t&&(0,d.jsxs)("div",{className:"schedule-content-grid",children:[(0,d.jsxs)("div",{className:"content-grid-header",children:[(0,d.jsx)("div",{className:"grid-header-cell",children:"Status"}),(0,d.jsx)("div",{className:"grid-header-cell",children:"Caption"}),(0,d.jsx)("div",{className:"grid-header-cell",children:"Time"}),(0,d.jsx)("div",{className:"grid-header-cell",children:"Media"}),(0,d.jsx)("div",{className:"grid-header-cell",children:"Actions"})]}),a.sort((e,s)=>e.scheduled_time.localeCompare(s.scheduled_time)).map(e=>(0,d.jsxs)("div",{className:"content-grid-row",children:[(0,d.jsx)("div",{className:"grid-cell status-cell",children:(0,d.jsxs)("span",{className:`post-status-badge ${e.status.toLowerCase()}`,children:[ce(e.status)," ",e.status]})}),(0,d.jsx)("div",{className:"grid-cell caption-cell",children:z&&z.id===e.id?(0,d.jsx)("textarea",{value:z.caption,onChange:e=>$(s=>({...s,caption:e.target.value})),className:"inline-caption-editor",rows:"4",placeholder:"Enter your caption..."}):(0,d.jsx)("div",{className:"caption-preview",onClick:()=>"scheduled"===e.status?he(e):null,style:{cursor:"scheduled"===e.status?"pointer":"not-allowed",opacity:"scheduled"===e.status?1:.6},children:e.caption.length>100?`${e.caption.substring(0,100)}...`:e.caption})}),(0,d.jsx)("div",{className:"grid-cell time-cell",children:(0,d.jsx)("span",{className:"schedule-time",children:e.scheduled_time})}),(0,d.jsx)("div",{className:"grid-cell media-cell",children:e.media_file?e.media_file.startsWith("data:image")||e.media_file.match(/\.(jpg|jpeg|png|gif|webp)$/i)?(0,d.jsx)("img",{src:e.media_file,alt:"Media",style:{maxWidth:60,maxHeight:60,borderRadius:6,border:"1px solid #eee"}}):e.media_file.startsWith("data:video")||e.media_file.match(/\.(mp4|webm|ogg)$/i)?(0,d.jsx)("video",{src:e.media_file,controls:!0,style:{maxWidth:80,maxHeight:60,borderRadius:6,border:"1px solid #eee"}}):(0,d.jsx)("a",{href:e.media_file,target:"_blank",rel:"noopener noreferrer",children:"View Media"}):(0,d.jsx)("span",{className:"no-media",children:"Text only"})}),(0,d.jsx)("div",{className:"grid-cell actions-cell",children:z&&z.id===e.id?(0,d.jsxs)("div",{className:"edit-actions",children:[(0,d.jsxs)("button",{onClick:me,className:"btn btn-success btn-small",children:[(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),(0,d.jsx)("polyline",{points:"17,21 17,13 7,13 7,21"}),(0,d.jsx)("polyline",{points:"7,3 7,8 15,8"})]}),(0,d.jsx)("span",{children:"Save"})]}),(0,d.jsxs)("button",{onClick:ue,className:"btn btn-secondary btn-small",children:[(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,d.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),(0,d.jsx)("span",{children:"Cancel"})]})]}):"scheduled"===e.status&&(0,d.jsxs)("div",{className:"post-actions",children:[(0,d.jsx)("button",{onClick:()=>he(e),className:"btn btn-primary btn-small",title:"Edit caption",children:(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,d.jsx)("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,d.jsx)("button",{onClick:()=>(async(e,s)=>{if(window.confirm(`Are you sure you want to cancel this scheduled post?\n\n"${s.substring(0,100)}..."`))try{await o.A.cancelBulkComposerPost(e),B(s=>s.filter(s=>s.id!==e)),alert("Scheduled post canceled successfully!")}catch(a){console.error("Error canceling post:",a),alert("Failed to cancel post. Please try again.")}})(e.id,e.caption),className:"btn btn-danger btn-small",title:"Cancel scheduled post",children:(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,d.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})})]})}),e.error_message&&(0,d.jsx)("div",{className:"grid-cell error-cell full-width",children:(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,d.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.error_message]})})]},e.id))]})]},e)})]}):(0,d.jsxs)("div",{className:"no-scheduled-posts",children:[(0,d.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("polyline",{points:"12,6 12,12 16,14"})]}),(0,d.jsx)("p",{children:"No scheduled posts yet. Create and schedule some posts above!"})]})})]})]}),P&&(0,d.jsx)("div",{className:"modal-overlay",children:(0,d.jsxs)("div",{className:"modal-content",children:[(0,d.jsxs)("div",{className:"modal-header",children:[(0,d.jsx)("h3",{children:"Edit Caption"}),(0,d.jsx)("button",{onClick:()=>D(null),className:"modal-close",children:"\xd7"})]}),(0,d.jsxs)("div",{className:"modal-body",children:[(0,d.jsx)("div",{className:"caption-info",children:(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"Scheduled:"})," ",P.scheduledDate," at ",P.scheduledTime]})}),(0,d.jsx)("textarea",{value:P.caption,onChange:e=>D(s=>({...s,caption:e.target.value})),className:"expanded-caption-textarea",rows:"10",placeholder:"Enter your caption..."})]}),(0,d.jsxs)("div",{className:"modal-footer",children:[(0,d.jsx)("button",{onClick:()=>D(null),className:"btn btn-secondary",children:"Cancel"}),(0,d.jsx)("button",{onClick:()=>{return e=P.caption,void(P&&(j(s=>s.map(s=>s.id===P.rowId?{...s,caption:e}:s)),D(null)));var e},className:"btn btn-primary",children:"Save Changes"})]})]})}),I&&(0,d.jsx)("div",{className:"modal-overlay",children:(0,d.jsxs)("div",{className:"modal-content media-preview-modal",children:[(0,d.jsxs)("div",{className:"modal-header",children:[(0,d.jsx)("h3",{children:"Media Preview"}),(0,d.jsx)("button",{onClick:()=>A(null),className:"modal-close",children:"\xd7"})]}),(0,d.jsxs)("div",{className:"modal-body",children:["image"===I.mediaType?(0,d.jsx)("img",{src:I.mediaUrl,alt:"Media preview",className:"modal-media"}):(0,d.jsx)("video",{src:I.mediaUrl,controls:!0,className:"modal-media"}),I.caption&&(0,d.jsxs)("div",{className:"modal-caption",children:[(0,d.jsx)("h4",{children:"Caption:"}),(0,d.jsx)("p",{children:I.caption})]})]}),(0,d.jsx)("div",{className:"modal-footer",children:(0,d.jsx)("button",{onClick:()=>A(null),className:"btn btn-primary",children:"Close"})})]})})]})},u=e=>{let{formData:s,setFormData:a,onGenerate:t,onGenerateImage:i,onGenerateImageWithCaption:n,onPublish:o,isPublishing:l,postHistory:r,isLoadingPosts:c,onRefreshPosts:h}=e;const m=e=>{const{name:s,value:t}=e.target;a(e=>({...e,[s]:t}))},u=e=>{a(s=>({...s,mediaType:e,mediaFile:null,generatedImageUrl:"ai_image"===e?s.generatedImageUrl:null,generatedImageFilename:"ai_image"===e?s.generatedImageFilename:null,imagePrompt:"ai_image"===e?s.imagePrompt:""}))};return(0,d.jsxs)("div",{className:"ai-generate-container",children:[(0,d.jsxs)("div",{className:"ai-generate-form",children:[(0,d.jsxs)("div",{className:"form-header",children:[(0,d.jsx)("div",{className:"form-icon",children:(0,d.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),(0,d.jsxs)("div",{className:"form-title-section",children:[(0,d.jsx)("h3",{className:"form-title",children:"AI Content Generation"}),(0,d.jsx)("p",{className:"form-subtitle",children:"Create engaging posts with AI assistance"})]})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsxs)("label",{className:"form-label",children:[(0,d.jsx)("span",{className:"label-text",children:"Content Prompt"}),(0,d.jsx)("span",{className:"label-hint",children:"Describe what you want to post about"})]}),(0,d.jsxs)("div",{className:"textarea-container",children:[(0,d.jsx)("textarea",{name:"prompt",value:s.prompt,onChange:m,placeholder:"e.g., Create a motivational post about achieving goals in 2024...",className:"form-textarea",rows:"3"}),(0,d.jsxs)("div",{className:"textarea-counter",children:[s.prompt.length,"/500"]})]})]}),(0,d.jsx)("div",{className:"form-group",children:(0,d.jsxs)("button",{onClick:t,disabled:!s.prompt.trim()||s.isGenerating,className:"action-btn primary",children:[(0,d.jsxs)("div",{className:"btn-content",children:[(0,d.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),(0,d.jsx)("span",{children:s.isGenerating?"Generating...":"Generate Content"})]}),s.isGenerating&&(0,d.jsx)("div",{className:"btn-loading",children:(0,d.jsx)("div",{className:"loading-spinner"})})]})}),s.generatedContent&&(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsxs)("label",{className:"form-label",children:[(0,d.jsx)("span",{className:"label-text",children:"Generated Content"}),(0,d.jsx)("span",{className:"label-hint",children:"Review and edit if needed"})]}),(0,d.jsxs)("div",{className:"generated-content-container",children:[(0,d.jsx)("textarea",{value:s.generatedContent,onChange:e=>a(s=>({...s,generatedContent:e.target.value})),className:"form-textarea generated-content",rows:"4"}),(0,d.jsx)("div",{className:"content-actions",children:(0,d.jsxs)("button",{onClick:t,disabled:s.isGenerating,className:"action-btn secondary small",children:[(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M23 4v6h-6"}),(0,d.jsx)("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),"Regenerate"]})})]})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsxs)("label",{className:"form-label",children:[(0,d.jsx)("span",{className:"label-text",children:"Media Options"}),(0,d.jsx)("span",{className:"label-hint",children:"Add visual content to your post"})]}),(0,d.jsxs)("div",{className:"media-options",children:[(0,d.jsxs)("button",{type:"button",className:"media-option "+("none"===s.mediaType?"active":""),onClick:()=>u("none"),children:[(0,d.jsx)("div",{className:"media-option-icon",children:(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,d.jsx)("polyline",{points:"14,2 14,8 20,8"}),(0,d.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,d.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]})}),(0,d.jsxs)("div",{className:"media-option-content",children:[(0,d.jsx)("span",{className:"media-option-title",children:"Text Only"}),(0,d.jsx)("span",{className:"media-option-desc",children:"No media attachment"})]})]}),(0,d.jsxs)("button",{type:"button",className:"media-option "+("ai_image"===s.mediaType?"active":""),onClick:()=>u("ai_image"),children:[(0,d.jsx)("div",{className:"media-option-icon",children:(0,d.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),(0,d.jsxs)("div",{className:"media-option-content",children:[(0,d.jsx)("span",{className:"media-option-title",children:"AI Image"}),(0,d.jsx)("span",{className:"media-option-desc",children:"Generate with AI"})]})]})]})]}),"ai_image"===s.mediaType&&(0,d.jsxs)("div",{className:"ai-image-section",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsxs)("label",{className:"form-label",children:[(0,d.jsx)("span",{className:"label-text",children:"Image Prompt"}),(0,d.jsx)("span",{className:"label-hint",children:"Describe the image you want to generate"})]}),(0,d.jsx)("input",{type:"text",name:"imagePrompt",value:s.imagePrompt,onChange:m,placeholder:"e.g., A modern office workspace with natural lighting...",className:"form-input"})]}),(0,d.jsx)("div",{className:"form-group",children:(0,d.jsxs)("button",{onClick:()=>i("auto"),disabled:!s.imagePrompt.trim()||s.isGeneratingImage,className:"action-btn secondary",children:[(0,d.jsxs)("div",{className:"btn-content",children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,d.jsx)("polyline",{points:"21,15 16,10 5,21"})]}),(0,d.jsx)("span",{children:s.isGeneratingImage?"Generating...":"Generate Image"})]}),s.isGeneratingImage&&(0,d.jsx)("div",{className:"btn-loading",children:(0,d.jsx)("div",{className:"loading-spinner"})})]})}),s.generatedImageUrl&&(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:(0,d.jsx)("span",{className:"label-text",children:"Generated Image"})}),(0,d.jsxs)("div",{className:"image-preview-container",children:[(0,d.jsx)("img",{src:s.generatedImageUrl,alt:"Generated",className:"preview-image"}),(0,d.jsx)("div",{className:"image-actions",children:(0,d.jsxs)("button",{onClick:()=>i("auto"),disabled:s.isGeneratingImage,className:"action-btn secondary small",children:[(0,d.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M23 4v6h-6"}),(0,d.jsx)("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),"Regenerate"]})})]})]})]}),(0,d.jsx)("div",{className:"quick-actions",children:(0,d.jsx)("button",{onClick:n,disabled:!s.prompt.trim()||s.isGenerating||s.isGeneratingImage,className:"action-btn success",children:(0,d.jsxs)("div",{className:"btn-content",children:[(0,d.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),(0,d.jsx)("span",{children:"Generate Content + Image"})]})})}),(0,d.jsx)("div",{className:"publish-section",children:(0,d.jsxs)("button",{onClick:o,disabled:!s.generatedContent||l,className:"publish-btn",children:[(0,d.jsxs)("div",{className:"btn-content",children:[(0,d.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M22 2L11 13"}),(0,d.jsx)("polygon",{points:"22,2 15,22 11,13 2,9"})]}),(0,d.jsx)("span",{children:l?"Publishing...":"Publish Post"})]}),l&&(0,d.jsx)("div",{className:"btn-loading",children:(0,d.jsx)("div",{className:"loading-spinner"})})]})})]}),(0,d.jsxs)("div",{className:"post-history-section",children:[(0,d.jsxs)("div",{className:"post-history-header",children:[(0,d.jsxs)("div",{className:"history-title",children:[(0,d.jsx)("h4",{children:"Recent AI Posts"}),(0,d.jsxs)("span",{className:"post-count",children:[r.length," posts"]})]}),(0,d.jsxs)("button",{onClick:h,disabled:c,className:"refresh-btn",children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M23 4v6h-6"}),(0,d.jsx)("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),!c&&"Refresh"]})]}),c?(0,d.jsxs)("div",{className:"loading-posts",children:[(0,d.jsx)("div",{className:"loading-spinner"}),(0,d.jsx)("span",{children:"Loading posts..."})]}):r.length>0?(0,d.jsx)("div",{className:"posts-list",children:r.map((e,s)=>(0,d.jsxs)("div",{className:"post-item",children:[(0,d.jsxs)("div",{className:"post-content",children:[(0,d.jsx)("p",{className:"post-text",children:e.content}),e.media_urls&&e.media_urls.length>0&&(0,d.jsx)("div",{className:"post-media",children:(0,d.jsx)("img",{src:e.media_urls[0],alt:"Post media",className:"post-image"})})]}),(0,d.jsxs)("div",{className:"post-meta",children:[(0,d.jsx)("span",{className:"post-date",children:new Date(e.created_at||e.next_execution).toLocaleDateString()}),(0,d.jsx)("span",{className:`post-status ${e.status}`,children:e.status})]})]},s))}):(0,d.jsxs)("div",{className:"no-posts",children:[(0,d.jsx)("div",{className:"no-posts-icon",children:(0,d.jsx)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),(0,d.jsx)("h4",{children:"No AI posts yet"}),(0,d.jsx)("p",{children:"Create your first AI-generated post to get started"})]})]})]})},p=e=>{let{formData:s,setFormData:a,onPublish:t,isPublishing:i,postHistory:n,isLoadingPosts:o,onRefreshPosts:l,onMediaTypeChange:r}=e;const c=e=>{const{name:s,value:t,files:i}=e.target;a(e=>({...e,[s]:i?i[0]:t}))},h=e=>{r?r(e,"manual"):a(s=>({...s,mediaType:e,mediaFile:null}))};return(0,d.jsxs)("div",{className:"manual-post-container",children:[(0,d.jsxs)("div",{className:"manual-post-form",children:[(0,d.jsxs)("div",{className:"form-header",children:[(0,d.jsx)("div",{className:"form-icon",children:(0,d.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,d.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,d.jsxs)("div",{className:"form-title-section",children:[(0,d.jsx)("h3",{className:"form-title",children:"Manual Post"}),(0,d.jsx)("p",{className:"form-subtitle",children:"Create and share your own content"})]})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsxs)("label",{className:"form-label",children:[(0,d.jsx)("span",{className:"label-text",children:"Post Message"}),(0,d.jsx)("span",{className:"label-hint",children:"Share what's on your mind"})]}),(0,d.jsxs)("div",{className:"textarea-container",children:[(0,d.jsx)("textarea",{name:"message",value:s.message,onChange:c,placeholder:"What's happening? Share your thoughts, updates, or announcements...",className:"form-textarea",rows:"5"}),(0,d.jsxs)("div",{className:"textarea-counter",children:[s.message.length,"/2000"]})]})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsxs)("label",{className:"form-label",children:[(0,d.jsx)("span",{className:"label-text",children:"Add Media"}),(0,d.jsx)("span",{className:"label-hint",children:"Enhance your post with visual content"})]}),(0,d.jsxs)("div",{className:"media-options",children:[(0,d.jsxs)("button",{type:"button",className:"media-option "+("none"===s.mediaType?"active":""),onClick:()=>h("none"),children:[(0,d.jsx)("div",{className:"media-option-icon",children:(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,d.jsx)("polyline",{points:"14,2 14,8 20,8"}),(0,d.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,d.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]})}),(0,d.jsxs)("div",{className:"media-option-content",children:[(0,d.jsx)("span",{className:"media-option-title",children:"Text Only"}),(0,d.jsx)("span",{className:"media-option-desc",children:"No media attachment"})]})]}),(0,d.jsxs)("button",{type:"button",className:"media-option "+("photo"===s.mediaType?"active":""),onClick:()=>h("photo"),children:[(0,d.jsx)("div",{className:"media-option-icon",children:(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,d.jsx)("polyline",{points:"21,15 16,10 5,21"})]})}),(0,d.jsxs)("div",{className:"media-option-content",children:[(0,d.jsx)("span",{className:"media-option-title",children:"Upload Photo"}),(0,d.jsx)("span",{className:"media-option-desc",children:"Add an image"})]})]}),(0,d.jsxs)("button",{type:"button",className:"media-option "+("video"===s.mediaType?"active":""),onClick:()=>h("video"),children:[(0,d.jsx)("div",{className:"media-option-icon",children:(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("polygon",{points:"23,7 16,12 23,17 23,7"}),(0,d.jsx)("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]})}),(0,d.jsxs)("div",{className:"media-option-content",children:[(0,d.jsx)("span",{className:"media-option-title",children:"Upload Video"}),(0,d.jsx)("span",{className:"media-option-desc",children:"Add a video"})]})]})]})]}),"photo"===s.mediaType&&(0,d.jsx)("div",{className:"media-upload-section",children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsxs)("label",{className:"form-label",children:[(0,d.jsx)("span",{className:"label-text",children:"Upload Photo"}),(0,d.jsx)("span",{className:"label-hint",children:"Select an image file (JPG, PNG, GIF)"})]}),(0,d.jsxs)("div",{className:"file-upload-area",children:[(0,d.jsx)("input",{type:"file",name:"mediaFile",accept:"image/*",onChange:c,className:"file-input",id:"photo-upload"}),(0,d.jsxs)("label",{htmlFor:"photo-upload",className:"file-upload-label",children:[(0,d.jsx)("div",{className:"upload-icon",children:(0,d.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,d.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,d.jsx)("polyline",{points:"21,15 16,10 5,21"})]})}),(0,d.jsxs)("div",{className:"upload-text",children:[(0,d.jsx)("span",{className:"upload-title",children:"Click to upload photo"}),(0,d.jsx)("span",{className:"upload-subtitle",children:"or drag and drop"})]})]})]}),s.mediaFile&&(0,d.jsxs)("div",{className:"media-preview",children:[(0,d.jsxs)("div",{className:"preview-header",children:[(0,d.jsx)("span",{className:"preview-title",children:"Selected Photo"}),(0,d.jsx)("button",{type:"button",onClick:()=>a(e=>({...e,mediaFile:null})),className:"remove-media-btn",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,d.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,d.jsx)("div",{className:"image-preview-container",children:(0,d.jsx)("img",{src:URL.createObjectURL(s.mediaFile),alt:"Preview",className:"preview-image"})}),(0,d.jsxs)("div",{className:"media-info",children:[(0,d.jsx)("span",{className:"file-name",children:s.mediaFile.name}),(0,d.jsxs)("span",{className:"file-size",children:[(s.mediaFile.size/1048576).toFixed(2)," MB"]})]})]})]})}),"video"===s.mediaType&&(0,d.jsx)("div",{className:"media-upload-section",children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsxs)("label",{className:"form-label",children:[(0,d.jsx)("span",{className:"label-text",children:"Upload Video"}),(0,d.jsx)("span",{className:"label-hint",children:"Select a video file (MP4, MOV, AVI)"})]}),(0,d.jsxs)("div",{className:"file-upload-area",children:[(0,d.jsx)("input",{type:"file",name:"mediaFile",accept:"video/*",onChange:c,className:"file-input",id:"video-upload"}),(0,d.jsxs)("label",{htmlFor:"video-upload",className:"file-upload-label",children:[(0,d.jsx)("div",{className:"upload-icon",children:(0,d.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("polygon",{points:"23,7 16,12 23,17 23,7"}),(0,d.jsx)("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]})}),(0,d.jsxs)("div",{className:"upload-text",children:[(0,d.jsx)("span",{className:"upload-title",children:"Click to upload video"}),(0,d.jsx)("span",{className:"upload-subtitle",children:"or drag and drop"})]})]})]}),s.mediaFile&&(0,d.jsxs)("div",{className:"media-preview",children:[(0,d.jsxs)("div",{className:"preview-header",children:[(0,d.jsx)("span",{className:"preview-title",children:"Selected Video"}),(0,d.jsx)("button",{type:"button",onClick:()=>a(e=>({...e,mediaFile:null})),className:"remove-media-btn",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,d.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,d.jsx)("div",{className:"video-preview-container",children:(0,d.jsx)("video",{src:URL.createObjectURL(s.mediaFile),controls:!0,className:"preview-video"})}),(0,d.jsxs)("div",{className:"media-info",children:[(0,d.jsx)("span",{className:"file-name",children:s.mediaFile.name}),(0,d.jsxs)("span",{className:"file-size",children:[(s.mediaFile.size/1048576).toFixed(2)," MB"]})]})]})]})}),(0,d.jsx)("div",{className:"publish-section",children:(0,d.jsxs)("button",{onClick:t,disabled:!s.message.trim()||i,className:"publish-btn",children:[(0,d.jsxs)("div",{className:"btn-content",children:[(0,d.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M22 2L11 13"}),(0,d.jsx)("polygon",{points:"22,2 15,22 11,13 2,9"})]}),(0,d.jsx)("span",{children:i?"Publishing...":"Publish Post"})]}),i&&(0,d.jsx)("div",{className:"btn-loading",children:(0,d.jsx)("div",{className:"loading-spinner"})})]})})]}),(0,d.jsxs)("div",{className:"post-history-section",children:[(0,d.jsxs)("div",{className:"post-history-header",children:[(0,d.jsxs)("div",{className:"history-title",children:[(0,d.jsx)("h4",{children:"Recent Manual Posts"}),(0,d.jsxs)("span",{className:"post-count",children:[n.length," posts"]})]}),(0,d.jsxs)("button",{onClick:l,disabled:o,className:"refresh-btn",children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M23 4v6h-6"}),(0,d.jsx)("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),!o&&"Refresh"]})]}),o?(0,d.jsxs)("div",{className:"loading-posts",children:[(0,d.jsx)("div",{className:"loading-spinner"}),(0,d.jsx)("span",{children:"Loading posts..."})]}):n.length>0?(0,d.jsx)("div",{className:"posts-list",children:n.map((e,s)=>(0,d.jsxs)("div",{className:"post-item",children:[(0,d.jsxs)("div",{className:"post-content",children:[(0,d.jsx)("p",{className:"post-text",children:e.content}),e.media_urls&&e.media_urls.length>0&&(0,d.jsx)("div",{className:"post-media",children:(0,d.jsx)("img",{src:e.media_urls[0],alt:"Post media",className:"post-image"})})]}),(0,d.jsxs)("div",{className:"post-meta",children:[(0,d.jsx)("span",{className:"post-date",children:new Date(e.created_at||e.next_execution).toLocaleDateString()}),(0,d.jsx)("span",{className:`post-status ${e.status}`,children:e.status})]})]},s))}):(0,d.jsxs)("div",{className:"no-posts",children:[(0,d.jsx)("div",{className:"no-posts-icon",children:(0,d.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",children:[(0,d.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,d.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,d.jsx)("h4",{children:"No manual posts yet"}),(0,d.jsx)("p",{children:"Create your first manual post to get started"})]})]})]})},g=e=>{var s;let{autoReplySettings:a,autoReplyMessageRule:t,autoReplyMessagesEnabled:i,autoReplyMessagesLoading:n,autoReplyMessagesError:o,onToggleAutoReplyMessages:l}=e;return(0,d.jsxs)("div",{className:"automate-container",children:[(0,d.jsxs)("div",{className:"automate-header",children:[(0,d.jsx)("div",{className:"automate-icon",children:(0,d.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,d.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),(0,d.jsxs)("div",{className:"automate-title-section",children:[(0,d.jsx)("h3",{className:"automate-title",children:"Automation Settings"}),(0,d.jsx)("p",{className:"automate-subtitle",children:"Configure automated responses and interactions"})]})]}),(0,d.jsxs)("div",{className:"automation-cards",children:[(0,d.jsxs)("div",{className:"automation-card",children:[(0,d.jsxs)("div",{className:"automation-card-header",children:[(0,d.jsx)("div",{className:"automation-card-icon comments",children:(0,d.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),(0,d.jsxs)("div",{className:"automation-card-content",children:[(0,d.jsx)("h4",{className:"automation-card-title",children:"Auto-Reply Comments"}),(0,d.jsx)("p",{className:"automation-card-description",children:"Automatically respond to comments on your posts with AI-generated replies"})]}),(0,d.jsx)("div",{className:"automation-status",children:(0,d.jsxs)("div",{className:"status-indicator always-on",children:[(0,d.jsx)("div",{className:"status-dot active"}),(0,d.jsx)("span",{className:"status-text",children:"Always On"})]})})]}),(0,d.jsxs)("div",{className:"automation-card-body",children:[(0,d.jsxs)("div",{className:"feature-highlight",children:[(0,d.jsx)("div",{className:"highlight-icon",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,d.jsx)("polyline",{points:"22,4 12,14.01 9,11.01"})]})}),(0,d.jsxs)("div",{className:"highlight-content",children:[(0,d.jsx)("span",{className:"highlight-title",children:"Smart AI Responses"}),(0,d.jsx)("span",{className:"highlight-description",children:"Every new post automatically gets AI-powered comment replies to boost engagement"})]})]}),(0,d.jsxs)("div",{className:"automation-info",children:[(0,d.jsx)("div",{className:"info-icon",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,d.jsx)("circle",{cx:"12",cy:"16",r:"1"})]})}),(0,d.jsx)("span",{className:"info-text",children:"This feature is enabled by default for all posts to maximize engagement and interaction with your audience."})]})]})]}),(0,d.jsxs)("div",{className:"automation-card",children:[(0,d.jsxs)("div",{className:"automation-card-header",children:[(0,d.jsx)("div",{className:"automation-card-icon messages",children:(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),(0,d.jsx)("polyline",{points:"22,6 12,13 2,6"})]})}),(0,d.jsxs)("div",{className:"automation-card-content",children:[(0,d.jsx)("h4",{className:"automation-card-title",children:"Auto-Reply Messages"}),(0,d.jsx)("p",{className:"automation-card-description",children:"Automatically respond to direct messages with customized replies"})]}),(0,d.jsxs)("div",{className:"automation-toggle",children:[(0,d.jsxs)("label",{className:"toggle-switch",children:[(0,d.jsx)("input",{type:"checkbox",checked:i,disabled:n||!t,onChange:l}),(0,d.jsx)("span",{className:"toggle-slider"})]}),(0,d.jsxs)("div",{className:"toggle-status",children:[(0,d.jsx)("span",{className:"status-text "+(i?"enabled":"disabled"),children:i?"On":"Off"}),n&&(0,d.jsx)("div",{className:"loading-spinner small"})]})]})]}),(0,d.jsxs)("div",{className:"automation-card-body",children:[o&&(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("div",{className:"error-icon",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,d.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})}),(0,d.jsx)("span",{children:o})]}),(0,d.jsxs)("div",{className:"message-template-section",children:[(0,d.jsxs)("div",{className:"template-header",children:[(0,d.jsx)("h5",{className:"template-title",children:"Message Template"}),(0,d.jsx)("span",{className:"template-hint",children:"This template will be used for auto-replies"})]}),(0,d.jsx)("div",{className:"template-preview",children:(0,d.jsx)("div",{className:"template-content",children:(null===t||void 0===t||null===(s=t.actions)||void 0===s?void 0:s.message_template)||"Thank you for your message! We'll get back to you soon."})})]}),(0,d.jsxs)("div",{className:"automation-note",children:[(0,d.jsx)("div",{className:"note-icon",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,d.jsx)("circle",{cx:"12",cy:"16",r:"1"})]})}),(0,d.jsx)("span",{className:"note-text",children:"To customize the auto-reply template or modify the automation logic, please contact your administrator."})]})]})]})]}),(0,d.jsxs)("div",{className:"automation-stats",children:[(0,d.jsxs)("div",{className:"stats-header",children:[(0,d.jsx)("h4",{className:"stats-title",children:"Automation Activity"}),(0,d.jsx)("span",{className:"stats-subtitle",children:"Recent automation performance"})]}),(0,d.jsxs)("div",{className:"stats-grid",children:[(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("div",{className:"stat-icon",children:(0,d.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),(0,d.jsxs)("div",{className:"stat-content",children:[(0,d.jsx)("div",{className:"stat-value",children:"--"}),(0,d.jsx)("div",{className:"stat-label",children:"Comments Replied"})]})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("div",{className:"stat-icon",children:(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),(0,d.jsx)("polyline",{points:"22,6 12,13 2,6"})]})}),(0,d.jsxs)("div",{className:"stat-content",children:[(0,d.jsx)("div",{className:"stat-value",children:"--"}),(0,d.jsx)("div",{className:"stat-label",children:"Messages Replied"})]})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("div",{className:"stat-icon",children:(0,d.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),(0,d.jsxs)("div",{className:"stat-content",children:[(0,d.jsx)("div",{className:"stat-value",children:"--"}),(0,d.jsx)("div",{className:"stat-label",children:"Engagement Rate"})]})]})]})]})]})},x=()=>{console.log("\ud83d\udd04 Resetting Facebook SDK completely"),window.FB&&delete window.FB,window.fbAsyncInit&&delete window.fbAsyncInit;document.querySelectorAll('script[src*="sdk.js"], script[id="facebook-jssdk"]').forEach(e=>e.remove()),console.log("\u2705 Facebook SDK reset complete")},v=e=>new Promise((s,a)=>{if(window.FB&&window.FB.login&&"function"===typeof window.FB.login)return console.log("\u2705 Facebook SDK already loaded and ready"),void s(window.FB);window.FB&&(console.log("\ud83d\udd04 Cleaning up existing Facebook SDK state"),delete window.FB),window.fbAsyncInit&&delete window.fbAsyncInit;const t=setTimeout(()=>{a(new Error("Facebook SDK loading timeout - please refresh the page"))},1e4);window.fbAsyncInit=function(){try{if(clearTimeout(t),console.log("\ud83d\udd04 Initializing Facebook SDK with App ID:",e),!e||"your_app_id_here"===e)return void a(new Error("Invalid Facebook App ID provided"));window.FB.init({appId:e,cookie:!0,xfbml:!0,version:"v18.0"}),console.log("\u2705 Facebook SDK initialized with version v18.0"),setTimeout(()=>{try{window.FB&&window.FB.AppEvents&&window.FB.AppEvents.logPageView(),console.log("\u2705 Facebook SDK ready for use"),s(window.FB)}catch(e){console.warn("\u26a0\ufe0f Facebook AppEvents failed, but SDK is ready:",e),s(window.FB)}},300)}catch(i){clearTimeout(t),console.error("\u274c Failed to initialize Facebook SDK:",i),a(new Error("Failed to initialize Facebook SDK: "+i.message))}};document.querySelectorAll('script[src*="sdk.js"]').forEach(e=>{console.log("\ud83d\udd04 Removing existing Facebook SDK script"),e.remove()});const i=document.createElement("script");i.src="https://connect.facebook.net/en_US/sdk.js",i.async=!0,i.defer=!0,i.crossOrigin="anonymous",i.id="facebook-jssdk",i.onload=()=>{console.log("\u2705 Facebook SDK script loaded successfully")},i.onerror=e=>{clearTimeout(t),console.error("\u274c Failed to load Facebook SDK script:",e),a(new Error("Failed to load Facebook SDK script"))},document.head.appendChild(i)}),j=e=>new Promise((s,a)=>{if(!e)return void a(new Error("No file provided"));const t=new FileReader;t.onload=()=>{s(t.result)},t.onerror=e=>{a(new Error("Failed to read file: "+e.message))},t.readAsDataURL(e)});const f=function(){var e,s;const a=(0,i.Zp)(),{logout:l}=(0,n.A)(),[r,c]=(0,t.useState)(!1),[h,f]=(0,t.useState)(""),[y,w]=(0,t.useState)(null),[b,N]=(0,t.useState)([]),[k,C]=(0,t.useState)(!1),[F,_]=(0,t.useState)("auto"),[S,P]=(0,t.useState)(!1),[D,I]=(0,t.useState)(!0),[A,T]=(0,t.useState)({prompt:"",mediaType:"none",mediaFile:null,generatedContent:"",isGenerating:!1,imagePrompt:"",generatedImageUrl:null,generatedImageFilename:null,isGeneratingImage:!1}),[B,M]=(0,t.useState)({message:"",mediaType:"none",mediaFile:null}),[E,W]=(0,t.useState)(!1),[R,L]=(0,t.useState)([]),[U,z]=(0,t.useState)([]),[$,G]=(0,t.useState)(!1),[H,K]=(0,t.useState)(!1),[O,V]=(0,t.useState)(!1),[q,Y]=(0,t.useState)(!0),[Q,Z]=(0,t.useState)(!1),[J,X]=(0,t.useState)(null),[ee,se]=(0,t.useState)({prompt:"",time:"",frequency:"daily",customDate:"",isActive:!1,scheduleId:null}),[ae,te]=(0,t.useState)(null),[ie,ne]=(0,t.useState)({enabled:!1,template:"Thank you for your comment! We appreciate your engagement. \ud83d\ude0a",ruleId:null,selectedPostIds:[]}),oe={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GOOGLE_DEVELOPER_KEY:"AIzaSyBrhx2_rqwr3LFnM9L_21KJQHc3g0nVznM",REACT_APP_INSTAGRAM_APP_ID:"697225659875731",REACT_APP_WS_URL:"wss://localhost:8000"}.REACT_APP_FACEBOOK_APP_ID||"697225659875731";(0,t.useEffect)(()=>{oe&&"your_app_id_here"!==oe?console.log("\u2705 Facebook App ID configured:",oe):console.warn("\u26a0\ufe0f Facebook App ID not configured properly. Please set REACT_APP_FACEBOOK_APP_ID in your environment variables.")},[oe]);const le=()=>window.innerWidth<=768,re=(0,t.useCallback)(async()=>{if(y)try{console.log("\ud83d\udd04 Loading auto-reply settings for page:",y.id,y.name);const a=await o.A.getAutomationRules("facebook","AUTO_REPLY");console.log("\ud83d\udccb Found automation rules:",a);const t=(await o.A.getSocialAccounts()).filter(e=>"facebook"===e.platform&&e.is_connected);console.log("\ufffd Faceboouk accounts:",t);const i=t.find(e=>e.platform_user_id===y.id);if(console.log("\ud83c\udfaf Matching account:",i),i){const t=a.find(e=>e.social_account_id===i.id);var e,s;if(console.log("\ud83e\udd16 Auto-reply rule found:",t),t)ne(e=>{var s,a;return{...e,enabled:t.is_active,template:(null===(s=t.actions)||void 0===s?void 0:s.response_template)||e.template,ruleId:t.id,selectedPostIds:(null===(a=t.actions)||void 0===a?void 0:a.selected_post_ids)||[]}}),console.log("\u2705 Auto-reply settings loaded:",{enabled:t.is_active,template:null===(e=t.actions)||void 0===e?void 0:e.response_template,ruleId:t.id,selectedPostIds:null===(s=t.actions)||void 0===s?void 0:s.selected_post_ids});else ne(e=>({...e,enabled:!1,template:"Thank you for your comment! We appreciate your engagement. \ud83d\ude0a",ruleId:null,selectedPostIds:[]})),console.log("\u274c No auto-reply rule found, using defaults")}else ne(e=>({...e,enabled:!1,template:"Thank you for your comment! We appreciate your engagement. \ufffd",ruleId:null,selectedPostIds:[]})),console.log("\u274c No matching account found, using defaults")}catch(a){console.error("\u274c Error loading auto-reply settings:",a)}},[y]),ce=(0,t.useCallback)(async()=>{try{I(!0);const s=await o.A.getFacebookStatus();if(s.connected){C(!0);let a=[],t=[];try{a=await o.A.getSocialAccounts(),t=a.filter(e=>"facebook"===e.platform&&e.is_connected)}catch(e){console.warn("Failed to fetch social accounts:",e)}const i=s.accounts.pages.map(e=>{const s=t.find(s=>s.platform_user_id===e.platform_id);return{id:e.platform_id,internalId:null===s||void 0===s?void 0:s.id,name:e.name,category:e.category,access_token:"",profilePicture:e.profile_picture||"",canPost:e.can_post,canComment:e.can_comment,followerCount:e.follower_count}});N(i),1===i.length&&w(i[0]),f(`Connected! ${s.pages_count} Facebook page(s) available.`)}else f("Ready to connect your Facebook account")}catch(s){console.error("Error checking Facebook status:",s),f("Unable to check Facebook connection status")}finally{I(!1)}},[]);(0,t.useEffect)(()=>{ce(),de();const e=()=>{f(e=>e)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[ce]),(0,t.useEffect)(()=>()=>{c(!1),W(!1),P(!1),I(!1)},[]);const de=async()=>{try{const{authenticated:e}=await o.A.getGoogleDriveStatus()}catch(e){console.warn("Drive status check failed:",e.message)}},he=(0,t.useCallback)(async()=>{if(y)try{G(!0);const e=(await o.A.getSocialPosts("facebook",50,y.internalId)).slice(0,50).sort((e,s)=>new Date(s.created_at||s.next_execution)-new Date(e.created_at||e.next_execution)),s=e.filter(e=>"ai_generated"===e.post_type||"ai"===e.generation_method||"ai"===e.content_source||e.metadata&&e.metadata.generated_by_ai).slice(0,10),a=e.filter(e=>"manual"===e.post_type||"manual"===e.generation_method||"manual"===e.content_source||!e.post_type&&!e.generation_method&&!e.content_source).slice(0,10);0===s.length&&0===a.length&&e.length>0?(L(e.slice(0,10)),z(e.slice(0,10))):(L(s),z(a)),console.log("\ud83d\udcca Post History Loaded:",{totalPosts:e.length,aiPosts:s.length,manualPosts:a.length,samplePost:e[0]})}catch(e){console.error("Error loading post history:",e),L([]),z([])}finally{G(!1)}},[y]);(0,t.useEffect)(()=>{y&&k&&(he(),re())},[y,k,F,he,re]);const me=async e=>{if(!e)return f("No Facebook access token found. Please try reconnecting."),c(!1),C(!1),{mappedPages:[],userInfo:null};try{var s;const a=(null===(s=(await new Promise((s,a)=>{window.FB.api("/me/permissions",{access_token:e},e=>{e.error?a(new Error(e.error.message)):s(e)})})).data)||void 0===s?void 0:s.filter(e=>"granted"===e.status).map(e=>e.permission))||[],t=["pages_show_list","pages_manage_posts"].filter(e=>!a.includes(e));t.length>0&&f(`Missing permissions: ${t.join(", ")}. Your app needs "Pages API" permissions.`);const i=await new Promise((s,a)=>{window.FB.api("/me",{access_token:e,fields:"id,name,email"},e=>{e.error?a(new Error(e.error.message)):s(e)})}),n=await new Promise((s,a)=>{window.FB.api("/me/accounts",{access_token:e,fields:"id,name,category,access_token,picture,fan_count,tasks"},e=>{e.error?a(new Error(`${e.error.message} (Code: ${e.error.code})`)):s(e)})}),o=(n.data||[]).map(e=>{var s,a;const t=e.tasks||[],i=t.includes("CREATE_CONTENT")||t.includes("MANAGE"),n=t.includes("MODERATE")||t.includes("MANAGE");return{id:e.id,internalId:null,name:e.name,category:e.category||"Page",access_token:e.access_token,profilePicture:(null===(s=e.picture)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.url)||"",canPost:i,canComment:n,followerCount:e.fan_count||0}});return N(o),1===o.length?(w(o[0]),f("Connected successfully! 1 page found."),setTimeout(()=>re(),500)):o.length>1?(w(null),f(`Connected successfully! ${o.length} pages found. Please select a page below.`)):(w({id:i.id,internalId:null,name:i.name,access_token:e,category:"Personal Profile",profilePicture:"",canPost:!0,canComment:!0,followerCount:0}),f("Connected as personal profile (no pages found)."),setTimeout(()=>re(),500)),C(!0),c(!1),{mappedPages:o,userInfo:i}}catch(a){return console.error("Facebook API error:",a),f("Failed to get Facebook data: "+(a.message||"Unknown error")),c(!1),C(!1),{mappedPages:[],userInfo:null}}},ue=async(e,s,t)=>{try{var i,n;const a=await o.A.connectFacebook(e,s.id,t);if("long_lived_user_token"===(null===(i=a.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.token_type)){const e=a.data.data.token_expires_at;if(e){const s=new Date(e);f(`Connected with long-lived token (expires: ${s.toLocaleDateString()})`)}else f("Connected with long-lived token")}return setTimeout(async()=>{try{const e=(await o.A.getSocialAccounts()).filter(e=>"facebook"===e.platform&&e.is_connected),s=b.map(s=>{const a=e.find(e=>e.platform_user_id===s.id);return{...s,internalId:null===a||void 0===a?void 0:a.id}});if(N(s),y){const s=e.find(e=>e.platform_user_id===y.id);s&&w(e=>({...e,internalId:s.id}))}}catch(e){console.error("Error updating page data with internal IDs:",e),f("Warning: Unable to get account details. You may need to reconnect Facebook for scheduling to work.")}},2e3),a}catch(p){var r,c,d,h;if(console.error("Backend connection error:",p),401===(null===(r=p.response)||void 0===r?void 0:r.status))f("Your session has expired. Please log out and log back in to connect Facebook."),setTimeout(()=>{l(),a("/")},3e3);else if(null!==(c=p.response)&&void 0!==c&&null!==(d=c.data)&&void 0!==d&&null!==(h=d.detail)&&void 0!==h&&h.includes("long-lived token"))f("Failed to get long-lived Facebook token. Please try reconnecting.");else{var m,u;f("Failed to connect to backend: "+((null===(m=p.response)||void 0===m||null===(u=m.data)||void 0===u?void 0:u.detail)||p.message))}throw p}},pe=(e,s)=>{console.log("File picker requested:",e,s)},ge=async()=>{if(!y)return void f("Please select a page first");const e="auto"===F,s=e?A.generatedContent:B.message,a=e?A.mediaType:B.mediaType,t=e?A.mediaFile:B.mediaFile,i=e?A.generatedImageUrl:B.generatedImageUrl,n=e?A.generatedImageFilename:B.generatedImageFilename;if(s&&""!==s.trim()||"video"===a)if("photo"!==a||t)if("video"!==a||t)if("ai_image"!==a||i&&n)try{W(!0),f("Publishing post to Facebook...");const r={postType:"feed"};if(e?A.generatedContent?r.textContent=A.generatedContent:A.prompt?(r.contentPrompt=A.prompt,r.useAIText=!0):r.textContent=s:s&&s.trim()&&(r.textContent=s),"ai_image"===a&&i&&n)r.imageUrl=i,r.imageFilename=n;else if("ai_image"===a&&(A.imagePrompt||B.imagePrompt)){const s=e?A.imagePrompt:B.imagePrompt;r.imagePrompt=s,r.useAIImage=!0}else if("photo"===a&&t){const e=await j(t);r.imageUrl=e}else if("video"===a&&t)try{const e=await j(t);r.videoUrl=e,r.videoFilename=t.name}catch(l){throw console.error("Error converting video to base64:",l),new Error("Failed to process video file: "+l.message)}if(!r.textContent&&!r.contentPrompt&&!r.imageUrl&&!r.imagePrompt&&!r.videoUrl)throw new Error("No content provided. Please add text content, generate content, or add media.");const c=await o.A.createFacebookPost(y.id,r);if(!c.success)throw new Error(c.error||"Failed to create post via backend");f("Post published successfully!"),setTimeout(()=>{he()},1e3),e?T(e=>({...e,prompt:"",generatedContent:"",mediaFile:null,mediaType:"none",imagePrompt:"",generatedImageUrl:null,generatedImageFilename:null})):M(e=>({...e,message:"",mediaFile:null,mediaType:"none",imagePrompt:"",generatedImageUrl:null,generatedImageFilename:null}))}catch(l){console.error("Post publishing error:",l),f("Failed to publish post: "+(l.message||"Unknown error"))}finally{W(!1)}else f("Please generate an image first");else f("Please select a video file to upload");else f("Please select a media file to upload");else f("Please enter some content for your post")},xe=(0,t.useCallback)(async()=>{if(y){Z(!0),X(null);try{const e=await o.A.getAutomationRules("facebook","AUTO_REPLY_MESSAGE"),s=(await o.A.getSocialAccounts()).find(e=>"facebook"===e.platform&&e.platform_user_id===y.id),a=e.find(e=>e.social_account_id===(null===s||void 0===s?void 0:s.id));a?(te(a),Y(!1!==a.is_active)):(te(null),Y(!0))}catch(e){X("Failed to load auto-reply message rule.")}finally{Z(!1)}}},[y]);return(0,t.useEffect)(()=>{xe()},[y,xe]),(0,d.jsxs)("div",{className:"facebook-page-container",children:[(0,d.jsxs)("div",{className:"facebook-header",children:[(0,d.jsxs)("div",{className:"facebook-header-left",children:[(0,d.jsx)("div",{className:"facebook-icon-container "+(k?"connected":""),children:(0,d.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"white",children:(0,d.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}),(0,d.jsxs)("div",{className:"facebook-header-content",children:[(0,d.jsx)("h1",{className:"facebook-title",children:k&&y?y.name:"Facebook Manager"}),(0,d.jsx)("div",{className:"facebook-subtitle",children:k?y?(0,d.jsxs)("div",{className:"page-status-info",children:[(0,d.jsx)("div",{className:"status-indicator connected"}),(0,d.jsx)("span",{className:"page-category",children:y.category}),(0,d.jsxs)("span",{className:"page-followers",children:[(null===(e=y.followerCount)||void 0===e?void 0:e.toLocaleString())||0," followers"]})]}):(0,d.jsxs)("div",{className:"page-status-info",children:[(0,d.jsx)("div",{className:"status-indicator connecting"}),(0,d.jsx)("span",{children:"Connected \u2022 Select a page to continue"})]}):(0,d.jsxs)("div",{className:"page-status-info",children:[(0,d.jsx)("div",{className:"status-indicator disconnected"}),(0,d.jsx)("span",{children:"Not connected \u2022 Ready to link your account"})]})})]})]}),(0,d.jsxs)("div",{className:"facebook-header-actions",children:[k&&(0,d.jsxs)("button",{onClick:async()=>{try{const s=ee||{};if(y&&s.isActive){if(!window.confirm(`\u26a0\ufe0f Warning: You have an active schedule for "${y.name}". Disconnecting will deactivate this schedule. Do you want to continue?`))return;try{await o.A.deleteScheduledPost(s.scheduleId),console.log("\u2705 Schedule deactivated before disconnect")}catch(e){console.warn("Failed to deactivate schedule before disconnect:",e)}}P(!0),f("Disconnecting from Facebook..."),await o.A.logoutFacebook(),C(!1),N([]),w(null),L([]),z([]),se({prompt:"",time:"",frequency:"daily",customDate:"",isActive:!1,scheduleId:null}),f("Successfully disconnected from Facebook"),setTimeout(()=>{f("Ready to connect your Facebook account")},3e3)}catch(s){console.error("Error logging out from Facebook:",s),f("Failed to disconnect from Facebook: "+s.message)}finally{P(!1)}},disabled:S,className:"header-action-btn disconnect-btn",title:"Disconnect Facebook",children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),(0,d.jsx)("polyline",{points:"16,17 21,12 16,7"}),(0,d.jsx)("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),!le()&&(S?"Disconnecting...":"Disconnect")]}),(0,d.jsxs)("button",{onClick:()=>a("/"),className:"header-action-btn dashboard-btn",title:"Back to Dashboard",children:[(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"m12 19-7-7 7-7"}),(0,d.jsx)("path",{d:"M19 12H5"})]}),!le()&&"Dashboard"]})]})]}),(0,d.jsxs)("div",{className:"facebook-main-content "+(k?"":"centered"),children:[h&&(0,d.jsx)("div",{className:`status-indicator-bar ${(h.includes("Failed")||h.includes("error")||h.includes("Error")?"status-card error":h.includes("successful")||h.includes("Connected")||h.includes("completed")?"status-card success":"status-card info").split(" ")[1]}`,children:(0,d.jsxs)("div",{className:"status-content",children:[(0,d.jsx)("div",{className:"status-icon",children:h.includes("Failed")||h.includes("error")?(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,d.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}):h.includes("successful")||h.includes("Connected")?(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,d.jsx)("polyline",{points:"22,4 12,14.01 9,11.01"})]}):(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,d.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,d.jsx)("circle",{cx:"12",cy:"16",r:"1"})]})}),(0,d.jsx)("span",{className:"status-text",children:h})]})}),(0,d.jsx)("div",{className:"facebook-main-card "+(k?"":"connect-mode"),children:k?(0,d.jsxs)("div",{className:"facebook-connected-content",children:[b.length>1&&(0,d.jsxs)("div",{className:"page-selector-card",children:[(0,d.jsxs)("div",{className:"page-selector-header",children:[(0,d.jsx)("div",{className:"page-selector-icon",children:(0,d.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),(0,d.jsx)("circle",{cx:"9",cy:"7",r:"4"}),(0,d.jsx)("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),(0,d.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}),(0,d.jsxs)("div",{className:"page-selector-content",children:[(0,d.jsx)("h3",{children:"Select Page"}),(0,d.jsx)("p",{children:"Choose which Facebook page to manage"})]})]}),(0,d.jsxs)("div",{className:"page-selector-dropdown",children:[(0,d.jsxs)("select",{className:"page-dropdown",value:(null===y||void 0===y?void 0:y.id)||"",onChange:e=>{const s=b.find(s=>s.id===e.target.value);s&&(null===y||void 0===y?void 0:y.id)!==s.id&&(w(s),L([]),z([]),K(!1),_("auto"),f(""),se({prompt:"",time:"",frequency:"daily",customDate:"",isActive:!1,scheduleId:null}),setTimeout(()=>{re(),he()},100))},children:[(0,d.jsx)("option",{value:"",disabled:!0,children:"Choose a page..."}),b.map(e=>(0,d.jsxs)("option",{value:e.id,children:[e.name," \u2022 ",e.category]},e.id))]}),(0,d.jsx)("div",{className:"dropdown-icon",children:(0,d.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("polyline",{points:"6,9 12,15 18,9"})})})]}),y&&(0,d.jsxs)("div",{className:"selected-page-info",children:[(0,d.jsx)("div",{className:"page-avatar",children:y.profilePicture?(0,d.jsx)("img",{src:y.profilePicture,alt:y.name,className:"page-avatar-image"}):(0,d.jsx)("div",{className:"page-avatar-placeholder",children:(0,d.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})}),(0,d.jsxs)("div",{className:"page-details",children:[(0,d.jsx)("div",{className:"page-name",children:y.name}),(0,d.jsxs)("div",{className:"page-stats",children:[(0,d.jsxs)("span",{className:"follower-count",children:[(null===(s=y.followerCount)||void 0===s?void 0:s.toLocaleString())||0," followers"]}),(0,d.jsxs)("div",{className:"connection-status",children:[(0,d.jsx)("div",{className:"status-dot connected"}),(0,d.jsx)("span",{children:"Connected"})]})]})]})]})]}),y&&(0,d.jsxs)("div",{className:"facebook-workspace",children:[(0,d.jsxs)("div",{className:"workspace-tabs",children:[(0,d.jsxs)("button",{className:"workspace-tab "+("auto"===F?"active":""),onClick:()=>{_("auto"),V(!1)},children:[(0,d.jsx)("div",{className:"tab-icon",children:(0,d.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,d.jsx)("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),(0,d.jsx)("span",{className:"tab-label",children:le()?"AI":"AI Generate"})]}),(0,d.jsxs)("button",{className:"workspace-tab "+("manual"===F?"active":""),onClick:()=>{_("manual"),V(!1)},children:[(0,d.jsx)("div",{className:"tab-icon",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,d.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,d.jsx)("span",{className:"tab-label",children:le()?"Manual":"Manual Post"})]}),(0,d.jsxs)("button",{className:"workspace-tab "+("bulk"===F?"active":""),onClick:()=>{_("bulk"),K(!0),V(!1)},children:[(0,d.jsx)("div",{className:"tab-icon",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("path",{d:"M3 3h18v18H3z"}),(0,d.jsx)("path",{d:"M9 9h6v6H9z"}),(0,d.jsx)("path",{d:"M15 3v18"}),(0,d.jsx)("path",{d:"M9 3v18"})]})}),(0,d.jsx)("span",{className:"tab-label",children:le()?"Bulk":"Bulk Posts"})]}),(0,d.jsxs)("button",{className:"workspace-tab "+("automate"===F?"active":""),onClick:()=>{_("automate"),V(!0)},children:[(0,d.jsx)("div",{className:"tab-icon",children:(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,d.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),(0,d.jsx)("span",{className:"tab-label",children:"Automate"})]})]}),(0,d.jsxs)("div",{className:"workspace-content",children:["auto"===F&&(0,d.jsx)(u,{formData:A,setFormData:T,onGenerate:async()=>{if(A.prompt.trim()){T(e=>({...e,isGenerating:!0})),f("Generating content with AI...");try{const e=await o.A.generateContent(A.prompt);T(s=>({...s,generatedContent:e.content,isGenerating:!1})),f("Content generated successfully!")}catch(e){console.error("Content generation error:",e),f("Failed to generate content: "+(e.message||"Unknown error")),T(e=>({...e,isGenerating:!1}))}}else f("Please enter a prompt for AI generation")},onGenerateImage:async e=>{const s="auto"===e?A:B,a="auto"===e?T:M,t=s.imagePrompt||s.prompt||("manual"===e?s.message:"");if(t.trim()){a(e=>({...e,isGeneratingImage:!0})),f("Generating image with AI...");try{const e=await o.A.generateFacebookImage(t,"feed");if(!e.success)throw new Error(e.error||"Image generation failed");a(s=>({...s,generatedImageUrl:e.data.image_url,generatedImageFilename:e.data.filename,isGeneratingImage:!1})),f("Image generated successfully!")}catch(i){console.error("Image generation error:",i),f("Failed to generate image: "+(i.message||"Unknown error")),a(e=>({...e,isGeneratingImage:!1}))}}else f("Please enter an image prompt or description")},onGenerateImageWithCaption:async()=>{if(A.prompt.trim()){T(e=>({...e,isGenerating:!0,isGeneratingImage:!0})),f("Generating image and caption with AI...");try{const e=await o.A.generateContent(A.prompt);if(!e.content)throw new Error("Failed to generate text content");const s=A.imagePrompt||A.prompt,a=await o.A.generateFacebookImage(s,"feed");if(!a.success)throw new Error(a.error||"Image generation failed");T(s=>({...s,generatedContent:e.content,generatedImageUrl:a.data.image_url,generatedImageFilename:a.data.filename,isGenerating:!1,isGeneratingImage:!1})),f("Image and caption generated successfully!")}catch(e){console.error("Image with caption generation error:",e),f("Failed to generate image and caption: "+(e.message||"Unknown error")),T(e=>({...e,isGenerating:!1,isGeneratingImage:!1}))}}else f("Please enter a prompt for generation")},onPublish:ge,isPublishing:E,postHistory:R,isLoadingPosts:$,onRefreshPosts:he}),"manual"===F&&(0,d.jsx)(p,{formData:B,setFormData:M,onPublish:ge,isPublishing:E,postHistory:U,isLoadingPosts:$,onRefreshPosts:he,onMediaTypeChange:(e,s)=>{"photo"!==e&&"video"!==e?"auto"===s?T(s=>({...s,mediaType:e,mediaFile:null,generatedImageUrl:"ai_image"===e?s.generatedImageUrl:null,generatedImageFilename:"ai_image"===e?s.generatedImageFilename:null,imagePrompt:"ai_image"===e?s.imagePrompt:""})):M(s=>({...s,mediaType:e,mediaFile:null,generatedImageUrl:"ai_image"===e?s.generatedImageUrl:null,generatedImageFilename:"ai_image"===e?s.generatedImageFilename:null,imagePrompt:"ai_image"===e?s.imagePrompt:""})):pe(e,s)}}),"bulk"===F&&H&&(0,d.jsx)(m,{selectedPage:y,availablePages:b,onPageChange:w,onClose:()=>{K(!1),_("auto")}}),"automate"===F&&O&&(0,d.jsx)(g,{autoReplySettings:ie,autoReplyMessageRule:ae,autoReplyMessagesEnabled:q,autoReplyMessagesLoading:Q,autoReplyMessagesError:J,onToggleAutoReplyMessages:async()=>{if(ae){Z(!0),X(null);try{const e=await o.A.updateAutomationRule(ae.id,{is_active:!q});Y(e.is_active),te(e)}catch(e){X("Failed to update auto-reply message rule.")}finally{Z(!1)}}}})]})]})]}):(0,d.jsxs)("div",{className:"connect-card",children:[(0,d.jsx)("div",{className:"connect-visual",children:(0,d.jsxs)("div",{className:"connect-icon-wrapper",children:[(0,d.jsx)("div",{className:"connect-icon",children:(0,d.jsx)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"white",children:(0,d.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}),(0,d.jsx)("div",{className:"connect-pulse"})]})}),(0,d.jsxs)("div",{className:"connect-content",children:[(0,d.jsx)("h2",{className:"connect-title",children:"Connect Your Facebook"}),(0,d.jsx)("p",{className:"connect-description",children:"Link your Facebook pages to start creating and managing posts with AI assistance"}),(0,d.jsxs)("button",{onClick:async()=>{if("https:"===window.location.protocol||"localhost"===window.location.hostname){try{await o.A.getCurrentUser()}catch(e){return f("Your session has expired. Please log out and log back in to connect Facebook."),void setTimeout(()=>{l(),a("/")},3e3)}c(!0),f("Loading Facebook SDK...");try{if(console.log("\ud83d\udd04 Loading Facebook SDK with App ID:",oe),await v(oe),!window.FB)throw new Error("Facebook SDK not loaded - window.FB is undefined");if("function"!==typeof window.FB.init)throw new Error("Facebook SDK not properly initialized - FB.init is not a function");if("function"!==typeof window.FB.login)throw new Error("Facebook SDK login function not available - FB.login is not a function");console.log("\u2705 Facebook SDK loaded successfully"),f("Connecting to Facebook..."),window.FB.login(s=>{s.authResponse&&s.authResponse.accessToken?(f("Facebook login successful! Fetching pages..."),(async()=>{try{const{mappedPages:e,userInfo:i}=await me(s.authResponse.accessToken);if(e.length>0){var a;f("Connecting to backend...");const t=await ue(s.authResponse.accessToken,i,e);null!==t&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.pages&&(N(e),f(`Connected successfully! ${t.data.pages_connected} pages synchronized with backend.`))}else{f("No pages found in Facebook API. Connecting to backend to check for existing connections...");try{await ue(s.authResponse.accessToken,i,[]);const e=(await o.A.getSocialAccounts()).filter(e=>"facebook"===e.platform&&"page"===e.account_type&&e.is_connected);if(e.length>0){const a=e.map(e=>{var a,t,i;return{id:e.platform_user_id,internalId:e.id,name:e.display_name,category:(null===(a=e.platform_data)||void 0===a?void 0:a.category)||"Page",access_token:e.access_token||s.authResponse.accessToken,profilePicture:e.profile_picture_url||"",canPost:!1!==(null===(t=e.platform_data)||void 0===t?void 0:t.can_post),canComment:!1!==(null===(i=e.platform_data)||void 0===i?void 0:i.can_comment),followerCount:e.follower_count||0}});N(a),f(`Found ${e.length} existing page(s) from previous connections!`)}else f("No pages found. You may need to grant page permissions or create a Facebook page first.")}catch(t){console.error("[FB.login] Backend check failed:",t),f("No pages found. You may need to grant page permissions or create a Facebook page first.")}}}catch(e){console.error("[FB.login] Error in page fetching or backend connection:",e),f("Error during setup: "+(e.message||"Unknown error")),c(!1),C(!1)}})()):("not_authorized"===s.status?f("Please authorize the app to continue and select at least one page."):f("Facebook login cancelled or failed"),c(!1))},{scope:["public_profile","pages_show_list","pages_read_engagement","pages_manage_posts","pages_manage_engagement","pages_read_user_content","pages_manage_metadata"].join(","),enable_profile_selector:!0,return_scopes:!0,auth_type:"rerequest",display:"popup"})}catch(e){console.error("Facebook login error:",e),c(!1),e.message.includes("init")||e.message.includes("version")||e.message.includes("SDK")?(console.log("\ud83d\udd04 Attempting to reset Facebook SDK due to initialization error"),x(),f("Facebook SDK initialization failed. Attempting to reset..."),setTimeout(async()=>{try{f("Retrying Facebook SDK initialization..."),await v(oe),f("Facebook SDK reset successful. Please try connecting again.")}catch(e){console.error("Facebook SDK retry failed:",e),f("Facebook SDK initialization failed. Please refresh the page and try again.")}},1e3)):f("Facebook login failed: "+e.message)}}else f("Facebook login requires HTTPS. Please use https://localhost:3001 or deploy with HTTPS")},disabled:r||D,className:"connect-button",children:[(0,d.jsxs)("div",{className:"connect-button-content",children:[(0,d.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:(0,d.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),(0,d.jsx)("span",{children:D?"Checking Connection...":r?"Connecting...":"Connect Facebook"})]}),(r||D)&&(0,d.jsx)("div",{className:"connect-loading",children:(0,d.jsx)("div",{className:"loading-spinner"})})]}),h.includes("failed")||h.includes("refresh")?(0,d.jsx)("button",{onClick:()=>{x(),f("Facebook SDK reset. Please try connecting again.")},className:"connect-button",style:{background:"transparent",border:"1px solid #1877f2",color:"#1877f2",marginTop:"1rem",fontSize:"0.875rem"},children:"Reset Facebook SDK"}):null]})]})})]})]})}},860:(e,s,a)=>{a.d(s,{bB:()=>t,xV:()=>i});a(579);const t=e=>new Promise((s,a)=>{const t=new FileReader;t.readAsDataURL(e),t.onload=()=>s(t.result),t.onerror=e=>a(e)}),i=e=>new Promise((s,a)=>{(()=>{try{if(window.FB){try{window.FB.getLoginStatus&&window.FB.logout()}catch(e){}delete window.FB}window.fbAsyncInit&&delete window.fbAsyncInit}catch(e){}})();const t=["v21.0","v20.0","v19.0","v18.0"];let i=0;const n=()=>{const o=t[i];if(window.fbAsyncInit=function(){try{window.FB.init({appId:e,cookie:!0,xfbml:!0,version:o,status:!0}),console.log(`Facebook SDK initialized successfully with ${o}`),window.FB.getLoginStatus(function(e){console.log("Facebook SDK test successful:",e.status),s()},!0)}catch(l){console.error(`Facebook SDK initialization failed with ${o}:`,l),i++,i<t.length?(console.log(`Trying Facebook SDK version ${t[i]}...`),setTimeout(n,500)):a(new Error("All Facebook SDK versions failed to initialize"))}},!document.getElementById("facebook-jssdk")){const e=document.createElement("script");e.id="facebook-jssdk",e.src="https://connect.facebook.net/en_US/sdk.js",e.async=!0,e.defer=!0,e.crossOrigin="anonymous",e.onerror=()=>{console.error(`Failed to load Facebook SDK script for ${o}`),i++,i<t.length?(console.log(`Trying Facebook SDK version ${t[i]}...`),setTimeout(n,500)):a(new Error("Failed to load Facebook SDK script"))},document.body.appendChild(e)}};n()})}}]);
//# sourceMappingURL=386.76529543.chunk.js.map